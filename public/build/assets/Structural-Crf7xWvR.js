import{s as H,r,u as S,C as J,G as K,q as Q,c as i,o as m,b as n,g as v,k as R,a as e,d as o,h as X,t as a,j as _,n as Y,f as N,i as V,F as T,y as Z,w as x}from"./app-UU5vQ_as.js";import{S as ee}from"./StaffLayout-UvpbO_91.js";import{_ as k}from"./InputError-BczuJaoE.js";import{_ as te}from"./Notif-Bj-7xZhG.js";import{_ as se}from"./ModalConfirmation-BcAsvzVu.js";import{C as F}from"./vue-select-DoDaMUQe.js";import{s as oe}from"./utils-Dr-qEmMV.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./format-DFpGNh8k.js";const le={class:"container me-lg-0 mx-auto mb-5"},ae={class:"row mt-4"},ne={class:"col-12"},de={class:"card shadow-sm p-lg-3 p-2"},re={class:"d-flex"},ie={class:"input-group ms-2"},me={class:"row gx-4 mt-4 mt-lg-5"},ue={class:"col-lg-4 col-12"},pe=["id","href"],ce=["onClick"],be={class:"d-flex"},fe={class:"",style:{"font-size":"0.8rem"}},ge={class:"text-secondary d-block"},ve={class:"h5 text-primary-emphasis d-block"},ye={class:"ms-auto mb-auto d-flex"},we=["onClick"],_e=["onClick"],xe={key:0,class:"modal fade",id:"newDepartmentModal",tabindex:"-1","aria-labelledby":"newDepartmentModal"},ke={class:"modal-dialog modal-dialog-centered"},he={class:"modal-content shadow mx-3"},De={class:"modal-header py-1 ps-3 pe-2"},Ce={class:"modal-body bg-light"},Me={class:"row justify-content-center"},Se={class:"col-8 col-lg-7"},Ne={class:"input-group input-group-sm bg-secondary bg-opacity-10 border-dark"},Ve={class:"row justify-content-center mt-2"},je={class:"col-8 col-lg-7"},Ue={key:1,class:"modal fade",id:"updateDepartmentModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},$e={class:"modal-dialog modal-dialog-centered"},Ee={class:"modal-content shadow mx-3"},Le={class:"modal-header py-1 ps-3 pe-2"},ze={class:"modal-title fs-5 text-primary-emphasis",id:"exampleModalLabel"},Ie={class:"modal-body bg-light"},Be={class:"row justify-content-center mt-0"},Re={class:"col-8 col-lg-7"},Te={class:"row justify-content-center mt-2"},Fe={class:"col-8 col-lg-7"},Oe={key:2,class:"modal fade",id:"deleteDepartmentModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Pe={class:"modal-dialog modal-dialog-centered"},Ae={class:"modal-content shadow mx-3"},qe={class:"modal-header py-1 ps-3 pe-2"},We={class:"modal-title text-primary-emphasis fs-5",id:"exampleModalLabel"},Ge={class:"modal-body bg-light"},He={class:"row justify-content-center"},Je={class:"col-12 col-lg-10"},Ke={class:"m-0",style:{"text-align":"justify"}},Qe={class:"row justify-content-center mt-2"},Xe={class:"col-9 col-lg-7"},Ye={class:"input-group"},it={__name:"Structural",props:{staff_list:Array,department_list:Array,filter:Object,notif:Object,errors:Object},setup(f){const c=f,g=H().props.auth.user,$=r("Structural"),O=r(null),y=r(null);r("placeholder");const h=r(null),D=r(null),C=r(null),b=r(null),u=S({category:c.filter.category,order:c.filter.order,keyword:c.filter.keyword}),p=S({name:null,manager_id:null}),d=S({name:null,manager_id:null}),w=S({password:null});function E(l){l&&(u.order=u.category==l?u.order=="asc"?"desc":"asc":"desc",u.category=l,u.keyword=null),u.post(route("structural.filter"))}function P(){p.post(route("department.add"),{onSuccess:()=>{j(!1),p.reset()}})}function A(){console.log(d),d.post(route("department.update",b.value.id),{onSuccess:()=>{L(!1),d.reset()},onError:l=>{for(let t in l)y.value.showToast("warning",l[t])}})}function q(){var l;w.post(route("department.delete",(l=b.value)==null?void 0:l.id),{onSuccess:()=>{z(!1),w.reset()},onError:t=>{for(let M in t)y.value.showToast("warning",t[M])}})}function j(l){if(h.value==null){const t=document.getElementById("newDepartmentModal");h.value=bootstrap.Modal.getOrCreateInstance(t)}l?h.value.show():h.value.hide()}function L(l){if(D.value==null){const t=document.getElementById("updateDepartmentModal");D.value=bootstrap.Modal.getOrCreateInstance(t)}l?D.value.show():D.value.hide()}function z(l){if(C.value==null){const t=document.getElementById("deleteDepartmentModal");C.value=bootstrap.Modal.getOrCreateInstance(t)}l?C.value.show():C.value.hide()}function W(l){document.getElementById("department_"+l).click()}const G=r(window.innerWidth>=768),U=()=>{G.value=window.innerWidth>=768,window.addEventListener("resize",U)};return J(()=>{window.addEventListener("resize",U),c.notif&&y.value.showToast(c.notif.type,c.notif.message)}),K(()=>{window.removeEventListener("resize",U)}),Q(()=>c.notif,l=>{const t=l;y.value.showToast(t.type,t.message)}),(l,t)=>{var M,I,B;return m(),i(T,null,[n(ee,null,{header:R(()=>[_(a($.value),1)]),default:R(()=>[n(o(X),{title:$.value,icon:"/storage/local/images/apps/logo.png"},null,8,["title"]),n(se,{ref_key:"modalConfirmationRef",ref:O},null,512),e("div",le,[e("div",ae,[e("div",ne,[e("div",de,[e("div",re,[t[17]||(t[17]=e("span",{class:"text-primary border-end border-secondary-subtle border-3 pe-3 me-3 my-auto"},a("Filter"),-1)),e("button",{onClick:t[0]||(t[0]=s=>E("name")),class:"btn text-nowrap btn-sm btn-outline-secondary border-1 rounded-2 border-secondary-subtle py-0"},[t[14]||(t[14]=_(a("Name")+" ",-1)),e("i",{class:Y("bi bi-arrow-"+(f.filter.category=="name"?f.filter.order=="asc"?"up":"down":"up"))},null,2)]),e("div",ie,[N(e("input",{type:"text",class:"form-control form-control-sm py-0",placeholder:"Search","aria-label":"Search","aria-describedby":"basic-addon1","onUpdate:modelValue":t[1]||(t[1]=s=>o(u).keyword=s),onInput:t[2]||(t[2]=s=>E())},null,544),[[V,o(u).keyword]]),t[15]||(t[15]=e("span",{class:"input-group-text py-0",id:"basic-addon1"},[e("i",{class:"bi bi-search",style:"font-size: 0.9rem"})],-1))]),o(g).roles_id==1?(m(),i("button",{key:0,class:"ms-2 btn btn-sm btn-outline-primary border-0 py-0 text-nowrap",onClick:t[3]||(t[3]=s=>j(!0))},[...t[16]||(t[16]=[e("i",{class:"bi bi-plus-lg d-lg-none"},null,-1),e("span",{class:"d-none d-lg-block"},a("New Department"),-1)])])):v("",!0)])])])]),e("div",me,[(m(!0),i(T,null,Z(f.department_list,s=>(m(),i("div",ue,[e("a",{id:"department_"+(s.id*7-4),href:l.route("department",s.id),class:"text-decoration-none"},null,8,pe),e("div",{class:"card card-bg-hover p-3 mb-3 mb-lg-4",onClick:Ze=>W(s.id*7-4)},[e("div",be,[e("div",fe,[e("span",ge,a(s.manager.name),1),e("span",ve,a("Department "+s.name),1)]),e("div",ye,[o(g).roles_id==1?(m(),i("button",{key:0,class:"border-0 btn btn-sm btn-outline-secondary",onClick:x(()=>{b.value=s,L(!0)},["stop"])},[...t[18]||(t[18]=[e("i",{class:"bi bi-pencil"},null,-1)])],8,we)):v("",!0),t[20]||(t[20]=e("div",{class:"border-start border-secondary border-2 mx-1 my-1"},null,-1)),o(g).roles_id==1?(m(),i("button",{key:1,class:"border-0 btn btn-sm btn-outline-secondary",onClick:x(()=>{b.value=s,z(!0)},["stop"])},[...t[19]||(t[19]=[e("i",{class:"bi bi-trash3"},null,-1)])],8,_e)):v("",!0)])])],8,ce)]))),256))])])]),_:1}),o(g).roles_id==1?(m(),i("div",xe,[e("div",ke,[e("div",he,[e("div",De,[t[22]||(t[22]=e("span",{class:"modal-title fs-5 text-primary-emphasis"},[e("i",{class:"bi bi-building-add pe-2"}),_(" "+a("New Department"))],-1)),e("button",{type:"button",class:"btn btn-sm ms-auto",onClick:t[4]||(t[4]=s=>j(!1))},[...t[21]||(t[21]=[e("i",{class:"bi bi-x-lg"},null,-1)])])]),e("form",{onSubmit:t[7]||(t[7]=x(s=>P(),["prevent"]))},[e("div",Ce,[e("div",Me,[t[24]||(t[24]=e("div",{class:"col-4 col-lg-3"},[e("label",{for:"department_name",class:"form-label d-inline-block"},a("Name"))],-1)),e("div",Se,[e("div",Ne,[t[23]||(t[23]=e("label",{class:"form-label text-secondary my-auto px-2",for:"department_name"},a("Department"),-1)),N(e("input",{type:"text",class:"form-control form-control-sm",id:"department_name","onUpdate:modelValue":t[5]||(t[5]=s=>o(p).name=s),placeholder:"Finance"},null,512),[[V,o(p).name]])]),n(k,{message:o(p).errors.name,class:"mt-2"},null,8,["message"])])]),e("div",Ve,[t[25]||(t[25]=e("div",{class:"col-4 col-lg-3"},[e("label",{for:"stand_pic",class:"form-label d-inline-block"},a("Manager"))],-1)),e("div",je,[n(o(F),{class:"bg-white text-nowrap",options:f.staff_list,label:"name",reduce:s=>s.id,modelValue:o(p).manager_id,"onUpdate:modelValue":t[6]||(t[6]=s=>o(p).manager_id=s),placeholder:"Select staff"},null,8,["options","reduce","modelValue"]),n(k,{message:o(p).errors.manager_id,class:"mt-2"},null,8,["message"])])])]),t[26]||(t[26]=e("div",{class:"modal-footer p-1"},[e("button",{type:"submit",class:"btn btn-sm btn-primary"},a("Create"))],-1))],32)])])])):v("",!0),o(g).roles_id==1?(m(),i("div",Ue,[e("div",$e,[e("div",Ee,[e("div",Le,[e("span",ze,[t[27]||(t[27]=e("i",{class:"bi bi-building-gear me-2"},null,-1)),_(" "+a("Update "+((M=b.value)==null?void 0:M.name))+" ",1),t[28]||(t[28]=e("span",{class:"d-none d-lg-inline"},a("Department"),-1))]),t[29]||(t[29]=e("button",{type:"button",class:"btn btn-sm ms-auto","data-bs-dismiss":"modal","aria-label":"Close"},[e("i",{class:"bi bi-x-lg"})],-1))]),e("form",{onSubmit:t[10]||(t[10]=x(s=>A(),["prevent"]))},[e("div",Ie,[e("div",Be,[t[30]||(t[30]=e("div",{class:"col-4 col-lg-3"},[e("label",{for:"edit_department_name",class:"form-label text-sm"},"Name")],-1)),e("div",Re,[N(e("input",{id:"edit_department_name",class:"form-control form-control-sm",type:"text",required:"","onUpdate:modelValue":t[8]||(t[8]=s=>o(d).name=s)},null,512),[[V,o(d).name]]),n(k,{messages:o(d).errors.name,class:"mt-2"},null,8,["messages"])])]),e("div",Te,[t[31]||(t[31]=e("div",{class:"col-4 col-lg-3"},[e("label",{for:"edit_department_manager",class:"form-label d-inline-block"},"Manager")],-1)),e("div",Fe,[n(o(F),{class:"bg-white text-nowrap",options:f.staff_list,label:"name",reduce:s=>s.id,modelValue:o(d).manager_id,"onUpdate:modelValue":t[9]||(t[9]=s=>o(d).manager_id=s),placeholder:"Select staff"},null,8,["options","reduce","modelValue"]),n(k,{messages:o(d).errors.manager_id,class:"mt-2"},null,8,["messages"])])])]),t[32]||(t[32]=e("div",{class:"modal-footer p-1"},[e("button",{type:"submit",class:"btn btn-sm btn-primary shadow"}," Update ")],-1))],32)])])])):v("",!0),o(g).roles_id==1?(m(),i("div",Oe,[e("div",Pe,[e("div",Ae,[e("div",qe,[e("span",We,[t[33]||(t[33]=e("i",{class:"bi bi-building-exclamation me-2"},null,-1)),_(" "+a("Delete "+((I=b.value)==null?void 0:I.name))+" ",1),t[34]||(t[34]=e("span",{class:"d-none d-lg-inline"},"Department",-1))]),t[35]||(t[35]=e("button",{type:"button",class:"btn btn-sm ms-auto","data-bs-dismiss":"modal","aria-label":"Close"},[e("i",{class:"bi bi-x-lg"})],-1))]),e("form",{onSubmit:t[13]||(t[13]=x(s=>q(),["prevent"]))},[e("div",Ge,[e("div",He,[e("div",Je,[e("p",Ke,a("All program and progress in "+((B=b.value)==null?void 0:B.name)+" Department will be lost. Please make sure you have back up all the data needed."),1)])]),t[38]||(t[38]=e("div",{class:"row justify-content-center mt-2"},[e("div",{class:"col-lg-10 col-11 border-bottom"},[e("span",{class:"d-block text-center"},[e("label",{for:"password"},"Password Needed to Authorize")])])],-1)),e("div",Qe,[t[37]||(t[37]=e("div",{class:"col-3 col-lg-3"},[e("label",{for:"pic",class:"form-label d-inline-block"},"Password")],-1)),e("div",Xe,[e("div",Ye,[N(e("input",{id:"password",class:"form-control",type:"password","onUpdate:modelValue":t[11]||(t[11]=s=>o(w).password=s),required:"",autocomplete:"current-password"},null,512),[[V,o(w).password]]),e("button",{type:"button",class:"btn bg-light",onClick:t[12]||(t[12]=s=>o(oe)("password","password_icon_del"))},[...t[36]||(t[36]=[e("i",{class:"bi bi-eye-slash-fill",id:"password_icon_del"},null,-1)])])]),n(k,{messages:o(w).errors.password,class:"mt-2"},null,8,["messages"])])])]),t[39]||(t[39]=e("div",{class:"modal-footer p-1"},[e("button",{type:"submit",class:"btn btn-sm btn-danger shadow"}," Delete ")],-1))],32)])])])):v("",!0),n(te,{ref_key:"toastNotifRef",ref:y},null,512)],64)}}};export{it as default};
