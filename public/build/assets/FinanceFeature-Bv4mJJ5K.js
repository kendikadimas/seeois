import{s as jt,r as h,m as lt,u as X,C as Nt,G as Bt,q as Ot,c as o,o as n,b as c,g as a,k as y,a as t,d as l,h as Tt,n as R,t as s,T as g,j as w,F as M,y as D,f as V,A as ot,i as Y,w as ct,p as At,e as Lt}from"./app-UU5vQ_as.js";import{S as Et}from"./StaffLayout-UvpbO_91.js";import{_ as F}from"./InputError-BczuJaoE.js";import{_ as It}from"./Notif-Bj-7xZhG.js";import{_ as Wt}from"./ModalConfirmation-BcAsvzVu.js";import{f as B,g as O,b as ut}from"./utils-Dr-qEmMV.js";import{t as qt}from"./format-DFpGNh8k.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";function Gt(i,f){return qt(i,f==null?void 0:f.in).getMonth()}const Ht={class:"container me-lg-0 mx-auto mb-5"},Jt={class:"row gx-2 mt-4 d-lg-none"},Kt={class:"col-12"},Qt={class:"card p-2 bg-light"},Xt={class:"d-flex"},Yt={class:"row gx-4 mt-4"},Zt={class:"col-12"},te={class:"card p-3 shadow-sm bg-white"},ee={class:"d-flex text-primary-emphasis h5"},se={class:"d-lg-none"},le={key:0},oe={key:0},ne={key:0,class:"mb-2"},ie={key:0},ae={class:"row gx-2"},re={class:"col-lg-10 col-12"},de={class:"row g-2"},ce={class:"col-6 col-lg-3"},ue={class:"text-dark"},me={class:"col-6 col-lg-3"},be={class:"text-dark"},ve={class:"col-6 col-lg-3"},fe={class:"text-dark"},pe={class:"col-6 col-lg-3"},ye=["href"],_e={class:"row"},ge={class:"col"},he={class:"d-flex mt-2 pt-1",style:"font-size: 0.8rem;"},xe={class:"ms-0 my-auto ms-lg-auto me-2 text-secondary"},ke={key:0},we={class:"row gx-2"},Ce={class:"col-12 col-lg-10"},Se={class:"row g-2"},ze={class:"col-12 col-lg-3"},Le={class:"row g-2"},Ue={class:"col-6 col-lg-12"},Me={class:"text-dark"},Ve={class:"col-6 col-lg-12"},Pe=["href"],Re={key:1},De={class:"col-12 col-lg-9"},Fe={class:"d-block mb-2"},$e={class:"text-secondary d-block",style:"font-size: 0.8rem;"},je={class:"row gx-2"},Ne={class:"col-4"},Be={class:"col-4"},Oe={class:"col-4 scroll-x-hidden"},Te={class:"text-nowrap"},Ae={class:"row"},Ee={class:"col"},Ie={class:"d-flex mt-2 pt-1",style:"font-size: 0.8rem;"},We={class:"ms-0 my-auto ms-lg-auto me-lg-2 text-secondary"},qe={class:"card border-top border-0 border-primary rounded-top-0"},Ge={class:"row g-2 mt-2"},He={class:"col-12 col-lg-3"},Je=["href"],Ke={class:"text-nowrap"},Qe={key:0,style:"font-size: 0.8rem;",class:"bi bi-box-arrow-up-right my-auto ms-2"},Xe={class:"col-12 col-lg-9"},Ye={class:"row gx-4"},Ze={key:0,class:"col-12 col-lg-6"},ts={class:"row g-2"},es={class:"col-12"},ss={class:"col-12"},ls={key:0,class:"text-dark d-block"},os={key:1,class:"d-block text-dark fst-italic"},ns={class:"col-12"},is={class:""},as=["onClick"],rs={key:0,class:"bi bi-circle-fill position-absolute top-0 start-100 translate-middle text-danger",style:"font-size: 0.5rem;"},ds={key:1,class:"text-secondary"},cs={key:0,class:"col-12"},us={class:"card mt-2 bg-light"},ms={class:"row mt-2"},bs={class:"col-12 d-flex"},vs=["href"],fs={class:"col-12"},ps={class:"card border-1 m-2"},ys=["src"],_s={key:0,class:"d-flex mb-1"},gs={key:1,class:"d-flex text-center w-100 px-2 mb-1"},hs={class:"fw-light text-secondary",style:"font-size: 0.8rem;"},xs={key:0,class:"scroll-x-hidden"},ks={class:"text-nowrap"},ws={class:"fw-light text-secondary ms-auto",style:"font-size: 0.8rem;"},Cs={key:0,class:"col-12 col-lg-6"},Ss={class:"row g-2"},zs={class:"col-12"},Ls={key:0,class:"mt-1"},Us={key:1,class:"input-group input-group-sm bg-light border rounded-2 mt-1"},Ms=["value"],Vs={class:"col-12"},Ps={key:0,class:"col-12"},Rs={class:"rounded-2 border"},Ds={class:"collapse p-3",id:"batchLevelAssignmentDiv"},Fs={class:"mb-3 d-block"},$s={class:"input-group input-group-sm bg-light border border-1 border-secondary-subtle rounded-2"},js=["value"],Ns={class:"row gx-4 mt-4"},Bs={class:"col-12 col-lg-6"},Os={key:0,class:"card sm p-3"},Ts={class:"d-flex mt-2"},As={class:"input-group"},Es={class:"scroll-container-2 scroll-container-lg-2"},Is={class:"list-group list-group-flush"},Ws={key:0,class:"list-group-item list-group-item-action"},qs=["onClick"],Gs={class:"mx-2 d-flex"},Hs=["value"],Js={key:1,class:"d-flex"},Ks={key:0,class:"text-danger ms-auto border-danger-subtle border px-2 rounded-2 text-nowrap d-flex",style:{"font-size":"0.8rem"}},Qs={key:2,class:"text-secondary ms-2"},Xs={key:0,class:"modal fade",id:"modalSettingContribution",tabindex:"-1","aria-labelledby":"modalSettingContribution"},Ys={class:"modal-dialog modal-dialog-centered"},Zs={class:"modal-content shadow mx-3 text-dark"},tl={class:"modal-body bg-light pt-1"},el={class:"row justify-content-center mb-2"},sl={class:"col-8 col-lg-7"},ll={class:"row justify-content-center mb-2"},ol={class:"col-8 col-lg-7"},nl=["value"],il={class:"row justify-content-center"},al={class:"col-8 col-lg-7"},rl=["value"],dl={key:1,class:"modal fade",id:"modalSettingPayroll",tabindex:"-1","aria-labelledby":"modalSettingPayroll"},cl={class:"modal-dialog modal-lg modal-dialog-centered"},ul={class:"modal-content shadow mx-3 text-dark"},ml={class:"modal-header py-1 ps-3 pe-2"},bl={class:"modal-body bg-light pt-3"},vl={class:"row justify-content-center mb-3"},fl={class:"col-12 col-lg-8"},pl={class:"input-group input-group-sm bg-secondary rounded-2 ps-2"},yl={class:"row justify-content-center mb-3"},_l={class:"col-12 col-lg-8"},gl={key:0,class:"d-flex mb-2"},hl={class:"me-2"},xl={class:"input-group input-group-sm bg-secondary text-white rounded-2 px-2"},kl=["for"],wl=["id","onUpdate:modelValue"],Cl=["id","onUpdate:modelValue"],Sl={class:"d-flex"},zl={class:"w-100"},Ll={class:"w-100"},Ul={class:"d-flex ms-2 my-auto"},Ml={class:"text-nowrap text-primary-emphasis"},Vl=["onClick"],Pl={class:"d-block mt-2"},Rl={key:0,class:"d-flex my-auto text-danger",style:{"font-size":"0.8rem"}},Dl={key:1,class:"d-flex my-auto text-danger",style:{"font-size":"0.8rem"}},El={__name:"FinanceFeature",props:{default_contribution_id:Number,contribution_config:Object,contribution_users:Array,payroll_detail:Array,payroll_balance:Object,filter:Object,notif:Object,errors:Object},setup(i){var ht,xt,kt;const f=i,P=jt().props.auth.user,mt=h("Finance Feature"),nt=h(null),it=h(null);h("placeholder");const bt=new Date,Z=h(null),tt=h(null),T=lt(()=>new Date().getMonth()+1),et=h(!1),vt=lt(()=>et.value?"up":"down"),A=h(!1);h(!1);const x=h(1),st=h(null),m=lt(()=>{var r;return(r=f.contribution_users.find(e=>e.id==j.value))==null?void 0:r.contribution.receipt.find(e=>e.id==st.value)}),j=h(null),b=lt(()=>f.contribution_users.find(r=>r.id==j.value)),C=X({price:((ht=f.contribution_config)==null?void 0:ht.financial_id)>0?f.contribution_config.price:0,start:((xt=f.contribution_config)==null?void 0:xt.financial_id)>0?f.contribution_config.start:new Date().getMonth(),end:((kt=f.contribution_config)==null?void 0:kt.financial_id)>0?f.contribution_config.period+f.contribution_config.start-1:new Date().getMonth()}),at=X({keyword:f.filter.contribution.keyword}),v=X({balance:f.payroll_balance.balance,level_list:f.payroll_detail}),E=X({user_id:null,level:null}),S=X({staff_id_list:[],level:""});function Ut(){C.post(route("contribution.settings"),{onSuccess:()=>{yt(!1),C.reset()},onError:r=>{for(let e in r)it.value.showToast("warning",r[e])}})}function Mt(){v.post(route("payroll.settings"),{onSuccess:()=>{rt(!1)}})}function ft(){E.post(route("payroll.update.single"))}function pt(){S.post(route("payroll.update.batch"))}function yt(r){if(Z.value==null){const e=document.getElementById("modalSettingContribution");Z.value=bootstrap.Modal.getOrCreateInstance(e)}r?Z.value.show():Z.value.hide()}function rt(r){if(tt.value==null){const e=document.getElementById("modalSettingPayroll");tt.value=bootstrap.Modal.getOrCreateInstance(e)}r?tt.value.show():tt.value.hide()}function Vt(r){j.value=r}function _t(r){st.value=r}function Pt(){at.post(route("contribution.filter"))}function Rt(){v.level_list.push({level:f.payroll_detail.length>0?Math.max(...v.level_list.filter(r=>r.deleted_at==null).map(r=>r.level))+1:0,salary:0,deleted_at:null})}function Dt(r){v.level_list[r].id>0?v.level_list[r].deleted_at=bt:v.level_list.splice(r,1)}function Ft(){v.reset()}function $t(r,e){nt.value?nt.value.showModal(r,e):console.error("modalConfirmationRef is null")}const I=h(window.innerWidth>=768),gt=()=>{I.value=window.innerWidth>=768};return Nt(()=>{window.addEventListener("resize",gt)}),Bt(()=>{window.removeEventListener("resize",gt)}),Ot(()=>f.notif,r=>{const e=r;it.value.showToast(e.type,e.message)}),(r,e)=>(n(),o(M,null,[c(Et,null,{header:y(()=>[w(s(mt.value),1)]),default:y(()=>{var d,_,N,wt;return[c(l(Tt),{title:mt.value,icon:"/storage/local/images/apps/logo.png"},null,8,["title"]),c(Wt,{ref_key:"modalConfirmationRef",ref:nt},null,512),t("div",Ht,[t("div",Jt,[t("div",Kt,[t("div",Qt,[t("div",Xt,[t("button",{class:R("btn btn-sm btn-outline-primary border-0 w-50 "+(x.value==1?"active":"")),onClick:e[0]||(e[0]=()=>{x.value=0})},s("Contribution"),2),e[25]||(e[25]=t("div",{class:"mx-1"},null,-1)),t("button",{class:R("btn btn-sm btn-outline-primary border-0 w-50 "+(x.value==2?"active":"")),onClick:e[1]||(e[1]=()=>{x.value=0})},s("Payroll"),2)])])])]),t("div",Yt,[t("div",Zt,[t("div",te,[t("div",ee,[e[26]||(e[26]=t("span",{class:"d-none d-lg-inline"},s("Contribution & Payroll"),-1)),t("div",se,[c(g,{name:"fade-slide-ltr",onAfterLeave:e[2]||(e[2]=()=>{x.value=2})},{default:y(()=>[x.value==1?(n(),o("span",le,s("Contribution"))):a("",!0)]),_:1}),c(g,{name:"fade-slide-rtl",onAfterLeave:e[3]||(e[3]=()=>{x.value=1})},{default:y(()=>[x.value==2?(n(),o("span",oe,s("Payroll"))):a("",!0)]),_:1})]),t("button",{onClick:e[4]||(e[4]=()=>et.value=!et.value),class:"btn btn-sm btn-outline-primary border-0 py-0 ms-auto",style:"font-size: 0.8rem;"},[w(s(vt.value=="up"?"hide":"settings")+" ",1),t("i",{class:R("bi my-auto bi-chevron-"+vt.value),style:"font-size: 0.8rem;"},null,2)])]),c(g,{name:"fade"},{default:y(()=>[et.value?(n(),o("div",ne,[c(g,{name:"fade-slide-ltr"},{default:y(()=>[x.value==1||I.value?(n(),o("div",ie,[t("div",ae,[e[32]||(e[32]=t("div",{class:"col-2 d-none d-lg-block"},[t("div",{class:"d-flex h-100"},[t("span",{class:"text-primary my-auto"},s("Contribution"))])],-1)),t("div",re,[t("div",de,[t("div",ce,[e[27]||(e[27]=t("span",{class:"text-secondary d-block",style:"font-size: 0.8rem;"},s("Charge"),-1)),t("span",ue,s(l(B)(i.contribution_config.price)),1)]),t("div",me,[e[28]||(e[28]=t("span",{class:"text-secondary d-block",style:"font-size: 0.8rem;"},s("Period"),-1)),t("span",be,s(l(O)(i.contribution_config.start)+" - "+l(O)(i.contribution_config.start+i.contribution_config.period-1)),1)]),t("div",ve,[e[29]||(e[29]=t("span",{class:"text-secondary d-block",style:"font-size: 0.8rem;"},s("Total"),-1)),t("span",fe,s(l(B)(i.contribution_config.period*i.contribution_config.price)),1)]),t("div",pe,[e[31]||(e[31]=t("span",{class:"text-secondary d-block",style:"font-size: 0.8rem;"},s("Set by"),-1)),t("a",{href:r.route("profile.edit",i.contribution_config.financial_id),class:"text-dark text-decoration-none d-flex"},[w(s(i.contribution_config.financial.name)+" ",1),e[30]||(e[30]=t("i",{style:"font-size: 0.8rem;",class:"bi bi-box-arrow-up-right my-auto ms-2"},null,-1))],8,ye)])])])]),t("div",_e,[t("div",ge,[t("div",he,[t("span",xe,s(i.contribution_config.financial_id>0?"Set on "+l(ut)(i.contribution_config.updated_at):"Wait for Financial set up"),1),l(P).roles_id==2?(n(),o("button",{key:0,class:"btn btn-sm btn-outline-secondary ms-auto ms-lg-0 py-0 d-flex border-0",onClick:e[5]||(e[5]=u=>yt(!0))},[...e[33]||(e[33]=[t("i",{class:"bi bi-gear my-auto",style:"font-size:0.8rem;"},null,-1)])])):a("",!0)])])])])):a("",!0)]),_:1}),c(g,{name:"fade-slide-rtl"},{default:y(()=>{var u,z,L;return[x.value==2||I.value?(n(),o("div",ke,[t("div",we,[e[37]||(e[37]=t("div",{class:"col-2 d-none d-lg-block"},[t("div",{class:"d-flex h-100"},[t("span",{class:"text-primary mt-2"},s("Payroll"))])],-1)),t("div",Ce,[t("div",Se,[t("div",ze,[t("div",Le,[t("div",Ue,[e[34]||(e[34]=t("span",{class:"text-secondary d-block",style:"font-size: 0.8rem;"},s("Budget"),-1)),t("span",Me,s(l(B)(i.payroll_balance.balance)),1)]),t("div",Ve,[e[36]||(e[36]=t("span",{class:"text-secondary d-block",style:"font-size: 0.8rem;"},s("Set by"),-1)),i.payroll_balance.financial_id>0?(n(),o("a",{key:0,href:r.route("profile.edit",(u=i.payroll_balance)==null?void 0:u.financial_id),class:"text-dark text-decoration-none d-flex"},[w(s(((L=(z=i.payroll_balance)==null?void 0:z.financial)==null?void 0:L.name)??"-")+" ",1),e[35]||(e[35]=t("i",{style:"font-size: 0.8rem;",class:"bi bi-box-arrow-up-right my-auto ms-2"},null,-1))],8,Pe)):(n(),o("span",Re,s(" - ")))])])]),t("div",De,[(n(!0),o(M,null,D(i.payroll_detail,k=>(n(),o("div",Fe,[t("span",$e,s("Level "+k.level),1),t("div",je,[t("div",Ne,s(k.salary+" percent"),1),t("div",Be,s(k.employee+(k.employee>1?" persons":" person")),1),t("div",Oe,[t("span",Te,s(l(B)(k.salary_idr)+" /person"),1)])])]))),256))])])])]),t("div",Ae,[t("div",Ee,[t("div",Ie,[t("span",We,s(i.payroll_balance.financial_id>0?"Set on "+l(ut)(i.payroll_balance.updated_at):"Wait for Financial set up"),1),l(P).roles_id==2?(n(),o("button",{key:0,class:"ms-auto ms-lg-0 btn btn-sm btn-outline-secondary py-0 d-flex border-0",onClick:e[6]||(e[6]=k=>rt(!0))},[...e[38]||(e[38]=[t("i",{class:"bi bi-gear my-auto",style:"font-size:0.8rem;"},null,-1)])])):a("",!0)])])])])):a("",!0)]}),_:1})])):a("",!0)]),_:1}),t("div",qe,[t("div",Ge,[t("div",He,[e[39]||(e[39]=t("span",{class:"text-secondary d-block",style:"font-size: 0.8rem;"},s("Staff"),-1)),t("a",{href:((d=b.value)==null?void 0:d.id)>0?r.route("profile.edit",(_=b.value)==null?void 0:_.id):"",class:"text-dark text-decoration-none d-flex scroll-x-hidden"},[t("span",Ke,s(((N=b.value)==null?void 0:N.id)>0?b.value.name:" - "),1),((wt=b.value)==null?void 0:wt.id)>0?(n(),o("i",Qe)):a("",!0)],8,Je)]),t("div",Xe,[t("div",Ye,[c(g,{name:"fade-slide-ltr"},{default:y(()=>{var u,z,L,k,p,W,Ct,St,zt;return[x.value==1||I.value?(n(),o("div",Ze,[t("div",ts,[e[46]||(e[46]=t("div",{class:"col-12 d-lg-block d-none"},[t("div",{class:"d-flex bg-light p-3"},[t("span",{class:"text-primary-emphasis h6 mb-0 text-center"},s("Contribution"))])],-1)),t("div",es,[e[40]||(e[40]=t("span",{style:"font-size:0.8rem;",class:"text-secondary d-block"},s("Progress "),-1)),(n(!0),o(M,null,D(i.contribution_config.period,U=>{var q,G,H,$,J,K,Q,dt;return n(),o("div",{class:R("btn shadow-sm px-1 py-0 me-2 "+(U+((q=i.contribution_config)==null?void 0:q.start)-1<=T.value&&U>((G=b.value)!=null&&G.contribution?($=(H=b.value)==null?void 0:H.contribution)==null?void 0:$.months:0)?"bg-danger bg-opacity-25":"")+(U<=((K=(J=b.value)==null?void 0:J.contribution)==null?void 0:K.months)?"bg-primary bg-opacity-25":"bg-secondary bg-opacity-25 border-dark-subtle border-1"))},[t("span",{style:"font-size: 0.7rem;",class:R("position-relative "+(U<=((dt=(Q=b.value)==null?void 0:Q.contribution)==null?void 0:dt.months)?"text-primary":"text-secondary"))},s(l(O)(U+i.contribution_config.start-1,"short")),3)],2)}),256))]),t("div",ss,[e[41]||(e[41]=t("span",{style:"font-size:0.8rem;",class:"text-secondary d-block mt-2"},s("Status "),-1)),j.value>0?(n(),o("span",ls,s(i.contribution_config.start+((u=b.value)!=null&&u.contribution?b.value.contribution.months-1:0)<=T.value?"Late for "+(T.value-((z=i.contribution_config)==null?void 0:z.start)-((L=b.value)!=null&&L.contribution?((p=(k=b.value)==null?void 0:k.contribution)==null?void 0:p.months)-1:-1)+(T.value-((W=i.contribution_config)==null?void 0:W.start)-((Ct=b.value)!=null&&Ct.contribution?((zt=(St=b.value)==null?void 0:St.contribution)==null?void 0:zt.months)-1:-1)>1?" months":" month")):"On track."),1)):a("",!0),j.value<=0?(n(),o("span",os,s("based on this month ("+l(O)(T.value)+")"),1)):a("",!0)]),t("div",ns,[e[43]||(e[43]=t("span",{style:"font-size:0.8rem;",class:"text-secondary d-block mt-2"},s("Receipt "),-1)),c(g,{name:"fade",mode:"out-in"},{default:y(()=>{var U,q,G,H;return[t("div",is,[(q=(U=b.value)==null?void 0:U.contribution)!=null&&q.receipt?(n(!0),o(M,{key:0},D((H=(G=b.value)==null?void 0:G.contribution)==null?void 0:H.receipt,$=>{var J,K,Q;return n(),o("button",{class:R("border-1 border-primary-subtle btn btn-sm btn-outline-primary me-2 py-0 position-relative "+($.id==((J=m.value)==null?void 0:J.id)?"active":"")),key:$.id,onClick:dt=>_t($.id)},[w(s(((Q=(K=b.value)==null?void 0:K.contribution)==null?void 0:Q.receipt.indexOf($))+1)+" ",1),e[42]||(e[42]=t("i",{class:"bi bi-receipt ms-0"},null,-1)),$.financial_id==null?(n(),o("i",rs)):a("",!0)],10,as)}),128)):(n(),o("span",ds,s(" - ")))])]}),_:1})]),c(g,{name:"fade"},{default:y(()=>[st.value?(n(),o("div",cs,[t("div",us,[t("div",ms,[t("div",bs,[t("a",{href:"/storage/images/receipt/contribution/"+m.value.receipt,class:"btn btn-sm btn-light border-0 mx-auto",download:""},[w(s(m.value.receipt)+" ",1),e[44]||(e[44]=t("i",{style:"font-size: 0.8rem;",class:"bi bi-download text-primary ms-2 my-auto"},null,-1))],8,vs),t("button",{class:"btn btn-sm btn-light me-2",onClick:e[7]||(e[7]=U=>_t(null))},[...e[45]||(e[45]=[t("i",{class:"bi bi-x-lg"},null,-1)])])]),t("div",fs,[t("div",ps,[c(g,{name:"fade",mode:"out-in"},{default:y(()=>[(n(),o("img",{key:m.value,src:"/storage/images/receipt/contribution/"+m.value.receipt,class:"w-100 rounded",alt:"image"},null,8,ys))]),_:1})]),l(P).roles_id==2?(n(),o("div",_s,[c(g,{name:"fade",mode:"out-in"},{default:y(()=>[t("button",{onClick:e[8]||(e[8]=U=>$t(r.route("contribution.validation",m.value.id),"Confirm to "+(m.value.financial_id?"unvalidate":"validate")+" "+m.value.receipt+"?")),class:R("mx-2 w-100 btn btn-sm btn-"+(m.value.financial_id?"secondary":"success")),style:"font-size: 0.8rem;"},s(m.value.financial_id?"Unvalid for "+m.value.months+(m.value.months>1?" months":" month"):"Valid for "+m.value.months+(m.value.months>1?" months":" month")),3)]),_:1})])):a("",!0),l(P).roles_id!==2?(n(),o("div",gs,[c(g,{name:"fade",mode:"out-in"},{default:y(()=>[t("span",hs,[w(s(m.value.financial_id?"Valid for "+m.value.months+(m.value.months>1?" months":" month")+" by ":"Unvalid for "+m.value.months+(m.value.months>1?" months":" month"))+" ",1),m.value.financial_id?(n(),o("span",xs,[t("span",ks,s(m.value.financial.name),1)])):a("",!0)])]),_:1}),c(g,{name:"fade",mode:"out-in"},{default:y(()=>[t("span",ws,s(m.value.financial_id?l(ut)(m.value.updated_at):""),1)]),_:1})])):a("",!0)])])])])):a("",!0)]),_:1})])])):a("",!0)]}),_:1}),c(g,{name:"fade-slide-rtl"},{default:y(()=>{var u,z,L,k;return[x.value==2||I.value?(n(),o("div",Cs,[t("div",Ss,[e[56]||(e[56]=t("div",{class:"col-12 d-lg-block d-none"},[t("div",{class:"d-flex bg-light p-3"},[t("span",{class:"text-primary-emphasis h6 mb-0 text-center"},s("Payroll"))])],-1)),t("div",zs,[e[49]||(e[49]=t("span",{class:"text-secondary d-block",style:{"font-size":"0.8rem"}},s("Level"),-1)),l(P).roles_id!==2||!(((u=b.value)==null?void 0:u.id)>0)?(n(),o("span",Ls,s(((z=b.value)==null?void 0:z.level)??" - "),1)):a("",!0),l(P).roles_id==2&&((L=b.value)==null?void 0:L.id)>0?(n(),o("div",Us,[V(t("select",{"onUpdate:modelValue":e[9]||(e[9]=p=>l(E).level=p),class:"form-select border-0"},[e[47]||(e[47]=t("option",{value:"0"},s("Unset"),-1)),(n(!0),o(M,null,D(i.payroll_detail,p=>(n(),o("option",{value:p.level},s("Level "+p.level),9,Ms))),256))],512),[[ot,l(E).level]]),t("button",{onClick:e[10]||(e[10]=(...p)=>ft&&ft(...p)),class:"btn btn-sm btn-outline-primary border-0 py-0"},[...e[48]||(e[48]=[t("i",{class:"bi bi-check-lg"},null,-1)])])])):a("",!0)]),t("div",Vs,[e[50]||(e[50]=t("span",{class:"text-secondary d-block",style:{"font-size":"0.8rem"}},s("Salary (Rp)"),-1)),t("span",null,s(l(B)(((k=i.payroll_detail.find(p=>{var W;return p.level==((W=b.value)==null?void 0:W.level)}))==null?void 0:k.salary_idr)??0)),1)]),l(P).roles_id==2?(n(),o("div",Ps,[t("div",Rs,[t("button",{onClick:e[11]||(e[11]=()=>{A.value=!A.value}),"data-bs-toggle":"collapse","data-bs-target":"#batchLevelAssignmentDiv",class:"btn btn-sm text-primary border-0 w-100 py-2 d-flex"},[...e[51]||(e[51]=[w(s("Batch Level Assignment")+" ",-1),t("i",{class:"bi bi-chevron-down ms-auto"},null,-1)])]),t("div",Ds,[e[54]||(e[54]=t("span",{class:"text-secondary d-block",style:{"font-size":"0.8rem"}},s("Selected staff"),-1)),t("span",Fs,s(l(S).staff_id_list.length+(l(S).staff_id_list.length>1?" persons":" person")),1),c(F,{message:l(S).errors.staff_id_list},null,8,["message"]),e[55]||(e[55]=t("span",{class:"text-secondary d-block",style:{"font-size":"0.8rem"}},s("Update to"),-1)),t("div",$s,[e[53]||(e[53]=t("span",{class:"form-label px-2 py-0 my-auto text-secondary",for:"batch_level"},s("Level"),-1)),V(t("select",{id:"batch_level","onUpdate:modelValue":e[12]||(e[12]=p=>l(S).level=p),class:"form-select border-0"},[e[52]||(e[52]=t("option",{value:""},s("Unset"),-1)),(n(!0),o(M,null,D(i.payroll_detail,p=>(n(),o("option",{value:p.level},s("Level "+p.level),9,js))),256))],512),[[ot,l(S).level]])]),c(F,{message:l(S).errors.level},null,8,["message"]),t("button",{onClick:e[13]||(e[13]=(...p)=>pt&&pt(...p)),class:"btn btn-sm btn-primary border-0 py-1 mt-3 w-100"},s("Update Level"))])])])):a("",!0)])])):a("",!0)]}),_:1})])])])])])])]),t("div",Ns,[t("div",Bs,[c(g,{name:"fade",mode:"out-in"},{default:y(()=>[st.value==null?(n(),o("div",Os,[e[60]||(e[60]=t("div",{class:"row"},[t("div",{class:"col-12"},[t("div",{class:"d-flex border-primary border-bottom pb-2"},[t("span",{class:"text-primary-emphasis me-auto my-auto h6"},[t("i",{class:"bi bi-people me-1"}),w(" "+s("Staff List"))])])])],-1)),t("div",Ts,[l(S).staff_id_list.length>0?(n(),o("button",{key:0,class:"btn btn-sm btn-outline-primary border me-2 text-nowrap",onClick:e[14]||(e[14]=()=>{l(S).staff_id_list=[]})},s("Unselect all"))):a("",!0),t("div",As,[V(t("input",{type:"text",class:"form-control form-control-sm py-0",placeholder:"Search","aria-label":"Search","aria-describedby":"basic-addon1","onUpdate:modelValue":e[15]||(e[15]=u=>l(at).keyword=u),onInput:Pt},null,544),[[Y,l(at).keyword]]),e[57]||(e[57]=t("span",{class:"input-group-text py-0",id:"basic-addon1"},[t("i",{class:"bi bi-search",style:"font-size: 0.9rem"})],-1))])]),t("div",Es,[t("li",Is,[i.contribution_users.length==0?(n(),o("ul",Ws,[...e[58]||(e[58]=[t("span",{class:"fst-italic text-secondary"},s("No employee found."),-1)])])):a("",!0),i.contribution_users.length>0?(n(!0),o(M,{key:1},D(i.contribution_users,u=>{var z;return n(),o("ul",{class:R("list-group-item list-group-item-action mb-0 py-1 px-0 "+(u.id==j.value?"bg-light":"")),onClick:()=>{Vt(u.id),l(E).level=u.level,l(E).user_id=u.id}},[t("div",Gs,[A.value?V((n(),o("input",{key:0,type:"checkbox",class:"form-check-input me-2","onUpdate:modelValue":e[16]||(e[16]=L=>l(S).staff_id_list=L),value:u.id,onClick:e[17]||(e[17]=ct(()=>{},["stop"]))},null,8,Hs)),[[At,l(S).staff_id_list]]):a("",!0),t("span",{class:R("me-auto "+(u.id==j.value?"":"text-secondary"))},s(u.name),3),A.value?a("",!0):(n(),o("div",Js,[((z=u.contribution)==null?void 0:z.months)+i.contribution_config.start-1<=l(Gt)(l(bt))+1||!u.contribution?(n(),o("span",Ks,[...e[59]||(e[59]=[t("span",{class:"my-auto"},s("Late"),-1),t("i",{class:"bi bi-exclamation my-auto"},null,-1)])])):a("",!0)])),A.value?(n(),o("span",Qs,s(u!=null&&u.level?"Level "+u.level:"Unset"),1)):a("",!0)])],10,qs)}),256)):a("",!0)])])])):a("",!0)]),_:1})])])])]}),_:1}),l(P).roles_id==2?(n(),o("div",Xs,[t("div",Ys,[t("div",Zs,[e[66]||(e[66]=Lt('<div class="modal-header py-1 ps-3 pe-2"><span class="modal-title fs-5 text-primary-emphasis"><i class="bi bi-gear border-secondary border-end me-2 pe-2"></i> Contribution Settings</span><button type="button" class="btn btn-sm ms-auto" data-bs-dismiss="modal" aria-label="Close"><i class="bi bi-x-lg"></i></button></div>',1)),t("form",{onSubmit:e[21]||(e[21]=ct(d=>Ut(),["prevent"]))},[t("div",tl,[e[64]||(e[64]=Lt('<div class="row pt-0"><div class="col-12"><div class="d-flex"><i class="bi bi-exclamation-triangle text-danger me-2 ms-auto my-auto pb-2 fs-4"></i><span style="font-size:0.8rem;" class="me-auto text-danger w-50 mb-1">Changing charge price may result in all receipts having to be  <span class="text-decoration-underline">revalidated</span> .</span></div></div></div>',1)),t("div",el,[e[61]||(e[61]=t("div",{class:"col-4 col-lg-3"},[t("label",{for:"contribution_setting_price",class:"form-label d-inline-block"},s("Charge"))],-1)),t("div",sl,[V(t("input",{type:"number",class:"form-control form-control-sm",id:"contribution_setting_price","onUpdate:modelValue":e[18]||(e[18]=d=>l(C).price=d),placeholder:"Dana Fakultas or etc..."},null,512),[[Y,l(C).price]]),c(F,{messages:l(C).errors.price,class:"mt-2"},null,8,["messages"])])]),t("div",ll,[e[62]||(e[62]=t("div",{class:"col-4 col-lg-3"},[t("label",{for:"contribution_setting_start",class:"form-label d-inline-block"},s("Start Month"))],-1)),t("div",ol,[V(t("select",{class:"form-control form-control-sm form-select",id:"contribution_setting_start","onUpdate:modelValue":e[19]||(e[19]=d=>l(C).start=d)},[(n(),o(M,null,D(12,d=>t("option",{value:d,key:d},s(l(O)(d)),9,nl)),64))],512),[[ot,l(C).start]]),c(F,{messages:l(C).errors.start,class:"mt-2"},null,8,["messages"])])]),t("div",il,[e[63]||(e[63]=t("div",{class:"col-4 col-lg-3"},[t("label",{for:"contribution_setting_end",class:"form-label d-inline-block"},s("End Month"))],-1)),t("div",al,[V(t("select",{class:"form-control form-control-sm form-select",id:"contribution_setting_end","onUpdate:modelValue":e[20]||(e[20]=d=>l(C).end=d)},[(n(),o(M,null,D(12,d=>t("option",{value:d,key:d},s(l(O)(d)),9,rl)),64))],512),[[ot,l(C).end]]),c(F,{messages:l(C).errors.end,class:"mt-2"},null,8,["messages"])])])]),e[65]||(e[65]=t("div",{class:"modal-footer p-1"},[t("button",{type:"submit",class:"btn btn-sm btn-primary"},s("Set"))],-1))],32)])])])):a("",!0),l(P).roles_id==2?(n(),o("div",dl,[t("div",cl,[t("div",ul,[t("div",ml,[e[68]||(e[68]=t("span",{class:"modal-title fs-5 text-primary-emphasis"},[t("i",{class:"bi bi-gear border-secondary border-end me-2 pe-2"}),w(" "+s("Payroll Settings"))],-1)),t("button",{type:"button",class:"btn btn-sm ms-auto",onClick:e[22]||(e[22]=d=>rt(!1))},[...e[67]||(e[67]=[t("i",{class:"bi bi-x-lg"},null,-1)])])]),t("form",{onSubmit:e[24]||(e[24]=ct(d=>Mt(),["prevent"]))},[t("div",bl,[t("div",vl,[e[70]||(e[70]=t("div",{class:"col-12 col-lg-2"},[t("label",{for:"payroll_setting_balance",class:"form-label d-inline-block ms-0"},s("Budget"))],-1)),t("div",fl,[t("div",pl,[e[69]||(e[69]=t("label",{for:"payroll_setting_balance",class:"form-label d-inline-block me-2 my-auto text-white"},s("Rp"),-1)),V(t("input",{type:"number",class:"form-control form-control-sm",id:"payroll_setting_balance","onUpdate:modelValue":e[23]||(e[23]=d=>l(v).balance=d),placeholder:"Dana Fakultas or etc..."},null,512),[[Y,l(v).balance]])]),c(F,{messages:l(v).errors.balance,class:"mt-2"},null,8,["messages"])])]),t("div",yl,[e[75]||(e[75]=t("div",{class:"col-12 col-lg-2"},[t("label",{class:"form-label d-inline-block ms-0"},s("Level"))],-1)),t("div",_l,[(n(!0),o(M,null,D(l(v).level_list,(d,_)=>(n(),o("div",null,[d.deleted_at==null?(n(),o("div",gl,[t("div",hl,[t("div",xl,[t("label",{for:"payroll_setting_level"+d.id,class:"form-label my-auto me-2"},s("Level"),8,kl),V(t("input",{type:"number",class:"form-control form-control-sm",id:"payroll_setting_level"+d.id,"onUpdate:modelValue":N=>l(v).level_list[_].level=N,placeholder:"ex: 1, 2, ..."},null,8,wl),[[Y,l(v).level_list[_].level]]),V(t("input",{type:"number",class:"form-control form-control-sm",id:"payroll_setting_salary"+d.id,"onUpdate:modelValue":N=>l(v).level_list[_].salary=N,placeholder:"ex: 20, 50, ..."},null,8,Cl),[[Y,l(v).level_list[_].salary]]),e[71]||(e[71]=t("span",{class:"form-label ms-2 my-auto"},s("%"),-1))]),t("div",Sl,[t("div",zl,[c(F,{messages:l(v).errors.level_list?l(v).errors.level_list[_].level:null,class:"mt-2"},null,8,["messages"])]),t("div",Ll,[c(F,{messages:l(v).errors.level_list?l(v).errors.level_list[_].salary:null,class:"mt-2"},null,8,["messages"])])])]),t("div",Ul,[t("span",Ml,s(l(B)(d.salary*i.payroll_balance.balance*.01)),1)]),t("button",{type:"button",onClick:N=>Dt(_),class:"btn btn-sm btn-outline-secondary border-0 py-0 ms-2"},[...e[72]||(e[72]=[t("i",{class:"bi bi-trash3"},null,-1)])],8,Vl)])):a("",!0)]))),256)),c(F,{message:l(v).errors.level_list},null,8,["message"]),t("div",Pl,[l(v).level_list.reduce((d,_)=>d+_.salary,0)>100?(n(),o("span",Rl,[...e[73]||(e[73]=[t("i",{class:"bi bi-exclamation-triangle me-2"},null,-1),w(" "+s("Warning! Total salary percentage is can`t be bigger than 100."),-1)])])):a("",!0),l(v).level_list.reduce((d,_)=>d+_.salary,0)<100?(n(),o("span",Dl,[...e[74]||(e[74]=[t("i",{class:"bi bi-exclamation-triangle me-2"},null,-1),w(" "+s("Warning! Total salary percentage is less than 100."),-1)])])):a("",!0),t("div",{class:"d-flex w-100"},[t("button",{type:"button",class:"btn btn-sm btn-outline-secondary border-0 py-0 text-nowrap",onClick:Ft},s("Reset")),t("button",{type:"button",class:"btn btn-sm btn-outline-primary border-0 py-0 ms-auto text-nowrap",onClick:Rt},s("New Level"))])])])])]),e[76]||(e[76]=t("div",{class:"modal-footer p-1"},[t("button",{type:"submit",class:"btn btn-sm btn-primary w-25"},s("Set"))],-1))],32)])])])):a("",!0),c(It,{ref_key:"toastNotifRef",ref:it},null,512)],64))}};export{El as default};
