import{N as B,A as g,V as E,a1 as U,B as h,c as l,o as n,d as y,D as f,E as V,l as $,b as s,f as b,h as o,t as a,p as P,w as L,q as S,F as w,e as C,U as T,S as v}from"./vendor-DX-UyPxd.js";import{S as j}from"./StaffLayout-tuRC_TMq.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./bootstrap-O9kK6gmf.js";import"./ModalConfirmation-CA9Q23sM.js";const q={class:"certificates-manage-container"},z={key:0,class:"alert alert-success-custom",role:"alert"},J={class:"alert-content"},K={key:1,class:"alert alert-danger-custom",role:"alert"},O={class:"alert-content"},G={class:"content-grid"},Q={class:"upload-card"},R={class:"card-body-custom"},W={class:"form-group-custom"},X=["value"],Y={key:0,class:"error-message"},Z={class:"form-group-custom"},ss={class:"file-input-wrapper"},es={for:"certificateFile",class:"file-label-custom"},ts={key:0},is={key:1,class:"file-selected"},ls={key:0,class:"error-message"},ns=["disabled"],as={key:0,class:"btn-content"},os={key:1,class:"btn-content"},rs={class:"certificates-card"},ds={class:"card-header-custom"},cs={class:"header-title-section"},us={class:"card-subtitle-custom"},ps={class:"certificates-list-wrapper"},fs={key:0,class:"empty-state"},ms={key:1,class:"certificates-table"},bs={class:"cert-header"},vs={class:"cert-info"},gs={class:"cert-recipient"},ks={class:"recipient-name"},_s={class:"recipient-email"},hs={class:"cert-meta"},ys={class:"meta-item"},Ss={class:"meta-item"},ws={class:"cert-footer"},Cs={class:"cert-stats"},xs={class:"stat-badge"},Ds={class:"cert-actions"},Ms=["onClick"],Fs=["onClick"],Ns={__name:"CertificatesManage",props:{interns:Array,certs:Array},setup(x){const d=x;B();const u=g(d.certs||[]),D=g(d.interns||[]);E(()=>{var i;console.log("Interns received:",d.interns),console.log("Interns count:",(i=d.interns)==null?void 0:i.length),console.log("Certs received:",d.certs),(!d.interns||d.interns.length===0)&&console.warn("⚠️ No interns data received from server!")});const m=g(!1),r=U({}),c=h({generated_for_user_id:"",file:null}),M=i=>i?new Date(i).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"}):"-",F=async()=>{m.value=!0,r.value={},c.post(v("certificate.store"),{onSuccess:()=>{c.reset(),m.value=!1,fetch(v("certificate.manage.index")).then(i=>i.text()).then(i=>{const e=document.createElement("div");e.innerHTML=i;const t=e.querySelector('script[type="application/json"]');if(t){const p=JSON.parse(t.textContent);p.props&&p.props.certs&&(u.value=p.props.certs)}})},onError:i=>{r.value=i,m.value=!1}})},N=i=>{window.location.href=v("certificate.download",i)},A=i=>{if(!confirm("Apakah Anda yakin ingin menghapus sertifikat ini?"))return;h({}).delete(v("certificate.destroy",i),{onSuccess:()=>{u.value=u.value.filter(t=>t.id!==i)}})};return(i,e)=>(n(),l("div",q,[y(f(V),{title:"Manajemen Sertifikat Internship"}),y(j,null,{default:$(()=>[e[31]||(e[31]=s("div",{class:"header-section"},[s("div",{class:"header-content"},[s("div",{class:"header-left"},[s("div",{class:"header-icon"},[s("i",{class:"bi bi-file-pdf"})]),s("div",{class:"header-text"},[s("h1",{class:"header-title"},"Manajemen Sertifikat Internship"),s("p",{class:"header-subtitle"},"Unggah, edit, dan kelola sertifikat Internship dari sini")])])])],-1)),i.$page.props.flash.success?(n(),l("div",z,[e[6]||(e[6]=s("i",{class:"bi bi-check-circle-fill"},null,-1)),s("div",J,[e[4]||(e[4]=s("strong",null,"Sukses!",-1)),o(" "+a(i.$page.props.flash.success),1)]),s("button",{type:"button",class:"alert-close",onClick:e[0]||(e[0]=t=>t.target.parentElement.style.display="none")},[...e[5]||(e[5]=[s("i",{class:"bi bi-x"},null,-1)])])])):b("",!0),i.$page.props.flash.error?(n(),l("div",K,[e[9]||(e[9]=s("i",{class:"bi bi-exclamation-circle-fill"},null,-1)),s("div",O,[e[7]||(e[7]=s("strong",null,"Error!",-1)),o(" "+a(i.$page.props.flash.error),1)]),s("button",{type:"button",class:"alert-close",onClick:e[1]||(e[1]=t=>t.target.parentElement.style.display="none")},[...e[8]||(e[8]=[s("i",{class:"bi bi-x"},null,-1)])])])):b("",!0),s("div",G,[s("div",Q,[e[20]||(e[20]=s("div",{class:"card-header-custom"},[s("div",{class:"header-icon-small"},[s("i",{class:"bi bi-cloud-upload"})]),s("h5",{class:"card-title-custom"},"Unggah Sertifikat Baru")],-1)),s("div",R,[s("form",{onSubmit:P(F,["prevent"]),class:"upload-form"},[s("div",W,[e[12]||(e[12]=s("label",{class:"form-label-custom"},[s("i",{class:"bi bi-person-check"}),o(" Pilih Intern ")],-1)),L(s("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>f(c).generated_for_user_id=t),class:S(["form-select-custom",{"is-invalid":r.generated_for_user_id}])},[e[10]||(e[10]=s("option",{value:""},"-- Pilih Intern --",-1)),(n(!0),l(w,null,C(D.value,t=>(n(),l("option",{key:t.id,value:t.id},a(t.name),9,X))),128))],2),[[T,f(c).generated_for_user_id]]),r.generated_for_user_id?(n(),l("div",Y,[e[11]||(e[11]=s("i",{class:"bi bi-exclamation-circle"},null,-1)),o(" "+a(r.generated_for_user_id[0]),1)])):b("",!0)]),s("div",Z,[e[16]||(e[16]=s("label",{class:"form-label-custom"},[s("i",{class:"bi bi-file-pdf"}),o(" File Sertifikat (PDF) ")],-1)),s("div",ss,[s("input",{type:"file",class:S(["file-input-custom",{"is-invalid":r.file}]),onChange:e[3]||(e[3]=t=>f(c).file=t.target.files[0]),accept:".pdf",id:"certificateFile"},null,34),s("label",es,[e[14]||(e[14]=s("i",{class:"bi bi-cloud-arrow-up"},null,-1)),f(c).file?(n(),l("span",is,[e[13]||(e[13]=s("i",{class:"bi bi-check-circle-fill text-success"},null,-1)),o(" "+a(f(c).file.name),1)])):(n(),l("span",ts,"Klik untuk memilih file atau drag & drop"))])]),e[17]||(e[17]=s("small",{class:"form-hint"},"Maksimal 20MB, format PDF",-1)),r.file?(n(),l("div",ls,[e[15]||(e[15]=s("i",{class:"bi bi-exclamation-circle"},null,-1)),o(" "+a(r.file[0]),1)])):b("",!0)]),s("button",{type:"submit",disabled:m.value,class:"btn-submit-custom"},[m.value?(n(),l("span",os,[...e[19]||(e[19]=[s("span",{class:"spinner-custom"},null,-1),o(" Mengunggah... ",-1)])])):(n(),l("span",as,[...e[18]||(e[18]=[s("i",{class:"bi bi-cloud-upload"},null,-1),o(" Unggah Sertifikat ",-1)])]))],8,ns)],32)])]),s("div",rs,[s("div",ds,[s("div",cs,[e[22]||(e[22]=s("div",{class:"header-icon-small"},[s("i",{class:"bi bi-list-check"})],-1)),s("div",null,[e[21]||(e[21]=s("h5",{class:"card-title-custom"},"Daftar Sertifikat",-1)),s("p",us,"Total: "+a(u.value.length)+" sertifikat",1)])])]),s("div",ps,[u.value.length===0?(n(),l("div",fs,[...e[23]||(e[23]=[s("div",{class:"empty-icon"},[s("i",{class:"bi bi-inbox"})],-1),s("h6",{class:"empty-title"},"Belum Ada Sertifikat",-1),s("p",{class:"empty-text"},"Mulai dengan mengunggah sertifikat baru di formulir di samping.",-1)])])):(n(),l("div",ms,[(n(!0),l(w,null,C(u.value,t=>{var p,k,_;return n(),l("div",{key:t.id,class:"certificate-item"},[s("div",bs,[s("div",vs,[s("div",gs,[e[24]||(e[24]=s("i",{class:"bi bi-person-circle"},null,-1)),s("div",null,[s("p",ks,a(((p=t.recipient)==null?void 0:p.name)||"N/A"),1),s("small",_s,a(((k=t.recipient)==null?void 0:k.email)||"-"),1)])])]),s("div",hs,[s("div",ys,[e[25]||(e[25]=s("i",{class:"bi bi-calendar-event"},null,-1)),s("span",null,a(M(t.issued_at)),1)]),s("div",Ss,[e[26]||(e[26]=s("i",{class:"bi bi-person-badge"},null,-1)),s("span",null,a(((_=t.issuer)==null?void 0:_.name)||"N/A"),1)])])]),s("div",ws,[s("div",Cs,[s("div",xs,[e[27]||(e[27]=s("i",{class:"bi bi-download"},null,-1)),s("span",null,a(t.download_count||0)+" unduhan",1)]),e[28]||(e[28]=s("div",{class:"status-badge published"},[s("i",{class:"bi bi-check2-circle"}),s("span",null,"Dipublikasikan")],-1))]),s("div",Ds,[s("button",{onClick:I=>N(t.id),class:"btn-action btn-download",title:"Unduh Sertifikat"},[...e[29]||(e[29]=[s("i",{class:"bi bi-download"},null,-1),s("span",null,"Unduh",-1)])],8,Ms),s("button",{onClick:I=>A(t.id),class:"btn-action btn-delete",title:"Hapus Sertifikat"},[...e[30]||(e[30]=[s("i",{class:"bi bi-trash"},null,-1),s("span",null,"Hapus",-1)])],8,Fs)])])])}),128))]))])])])]),_:1})]))}},Vs=H(Ns,[["__scopeId","data-v-2e5800d8"]]);export{Vs as default};
