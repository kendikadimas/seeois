import{s as K,r as h,u as Q,k as L,D as X,H as Z,p as W,c as l,o as d,b as M,a as s,j as q,d as i,h as ss,B as O,I as ts,t as n,i as f,n as x,f as g,T as B,F as w,y as k,q as es}from"./app-CR2mpfjv.js";import{_ as ns}from"./Notif-BJpCZgA4.js";import{G as as}from"./GuestLayout-Mx0waACV.js";import{_ as os}from"./ModalConfirmation-aFADB0PC.js";import{a as D,f as m}from"./utils-Dr-qEmMV.js";import{f as j}from"./format-DFpGNh8k.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const is={class:"card shadow-lg mx-auto px-3 py-3"},ls={class:"d-flex text-primary-emphasis"},ds={class:"h5 my-auto"},rs={class:"container pb-5",style:{"min-height":"100vh","margin-top":"8rem"}},cs={class:"row g-4"},ps={class:"col-12 d-block d-xl-none"},us={class:"d-flex bg-white shadow-sm p-2 mb-2"},ms={key:0,class:"bg-danger text-white rounded-2 ms-2",style:{"font-size":"0.7rem",padding:"0.1rem 0.5rem"}},bs={key:0,class:"col-12 col-xl-8"},_s={class:"card bg-white shadow-sm p-0"},ys={class:"d-flex shadow-sm"},gs={class:"text-secondary ms-auto me-3 my-auto",style:{"font-size":"0.8rem"}},fs={class:"ms-1 fw-bold"},xs={class:"scroll-container-lg-5 scroll-container-4 scroll-thumb-warning pe-1"},ws={key:0,class:"d-flex w-100 p-2"},vs={class:"text-secondary fst-italic mx-auto"},hs={class:"list-group list-group-flush"},ks={class:"list-group-item mb-0 bg-warning bg-opacity-10"},Cs={class:"text-warning-emphasis"},zs=["onClick"],Ss={class:"text-nowrap p-1"},Ts=["src"],Ms={class:"d-flex"},Ls={class:"scroll-x-hidden me-2 my-auto"},Ns={class:"d-flex"},Os={class:"text-primary-emphasis text-nowrap me-1"},Ds={class:"ms-1 h6"},Ps={class:""},Rs={class:"text-secondary d-inline-block text-nowrap"},$s={class:"d-block"},qs={class:"d-inline-flex me-5",style:{"flex-wrap":"wrap"}},Vs={class:"py-0 px-2 ms-2 mb-2 rounded-1 bg-secondary bg-opacity-10 text-secondary d-inline-block border-0",style:{borderWidth:"1px",borderStyle:"solid",fontSize:"0.8rem"}},Es={key:0,class:"py-0 px-2 ms-2 rounded-1 border-secondary text-secondary mb-2",style:{borderWidth:"1px",borderStyle:"solid",fontSize:"0.8rem"}},Is={class:""},Ws={class:"text-dark my-auto text-nowrap"},Bs={key:0,class:"col-12 col-xl-4"},js={class:"card bg-white shadow-sm p-3"},As={key:0,class:"d-flex w-100 p-2"},Hs={class:"text-secondary fst-italic mx-auto"},Us={class:"scroll-container-lg-3 scroll-container-3 scroll-thumb-warning pe-1"},Fs={class:"list-group list-group-flush"},Ys={class:"list-group-item list-group-item-action px-0 py-1 mb-0"},Gs={class:"w-25 float-start"},Js=["src"],Ks={class:"w-75 float-end ps-3"},Qs={class:"d-block text-primary-emphasis"},Xs={class:""},Zs={class:""},st={class:""},tt={class:"h6"},et={class:"d-flex"},nt=["onClick"],at={class:"d-inline block bg-warning bg-opacity-10 px-2 text-warning-emphasis h6 mb-0"},ot=["onClick"],it={class:"card bg-white shadow-sm p-3 mt-4"},lt={class:"d-flex"},dt={class:"text-secondary"},rt={class:"ms-auto"},ct={class:"d-flex mt-2"},pt={class:"bg-warning bg-opacity-10 ms-auto rounded"},ut=["disabled"],mt={class:""},bt={class:"d-flex mt-2"},_t={class:"ms-auto"},yt={class:"d-flex mt-2 rounded bg-warning bg-opacity-25 p-1"},gt=["disabled"],ft={class:"h6 my-auto ms-auto text-warning-emphasis"},xt={class:"modal fade",id:"voucherModal",tabindex:"-1","aria-labelledby":"voucherModal"},wt={class:"modal-dialog modal-dialog-centered"},vt={class:"modal-content shadow mx-3"},ht={class:"modal-body bg-light rounded-bottom p-0"},kt={class:"d-flex"},Ct={class:"scroll-container-4 scroll-container-lg-4 px-3 pt-3"},zt={class:"d-block border-secondary-subtle rounded-3 border-0 bg-primary bg-opacity-25 my-2 mx-4 w-100 py-2 px-3"},St=["src"],Tt={class:"rounded bg-white p-3",style:{width:"100%"}},Mt={class:"d-flex bg-success bg-opacity-10 rounded-top"},Lt={class:"text-primary h6 mb-0 mx-auto py-1"},Nt={class:"d-flex"},Ot={class:"text-primary-emphasis",style:{"font-size":"0.8rem"}},Dt={class:"h6 mb-0",style:{"font-size":"0.8rem"}},Pt={class:"d-flex mb-2"},Rt={class:"text-secondary",style:{"font-size":"0.8rem"}},$t={class:"mb-2"},qt={class:"card border text-secondary"},Vt=["id","data-bs-target","onClick"],Et=["id"],It={class:"list-group list-group-flush"},Wt={class:"list-group-item list-group-item-action mb-0 py-1"},Bt={class:"d-inline"},jt={class:"mb-0"},At={key:0,class:"bi bi-exclamation-circle-fill text-danger rounded-circle p-0"},Ht={class:"mb-0 fst-italic text-secondary"},Ut={class:"d-flex"},Ft=["onClick"],Yt={key:0,class:"mb-5 mt-3"},te={__name:"Stand",props:{notif:Object,stand:Object,menu_group:Object,customer_voucher:Array,active_transaction:Object},setup(C){var I;const b=C,z=K().props.auth.user,A=h("Stand "+b.stand.name),_=h(null),P=h(null),y=h(1),S=h(window.innerWidth>=1200),R=h(0),V=()=>{R.value=window.scrollY},p=Q({stand_id:b.stand.id,order_list:[],voucher_id:null,discount:null,transaction:null}),u=h(((I=b.active_transaction)==null?void 0:I.order_list)??[]),v=L(()=>u.value.reduce((o,t)=>o+t.price*t.qty,0)),E=L(()=>u.value.reduce((o,t)=>o+Number(t.qty),0)),N=L(()=>{const o=b.customer_voucher.find(t=>t.id==p.voucher_id);if(o!=null&&o.discount_percent){const t=v.value*(o==null?void 0:o.discount_percent)/100;return t>o.discount_max_price?o.discount_max_price:t}else if(o!=null&&o.discount_price)return o==null?void 0:o.discount_price}),H=L(()=>{if(b.stand.type==0)return"Now";if(b.stand.type==1)return"Pre-Order";if(b.stand.type==2)return"Now / Pre-Order"}),U=L(()=>{const o=Math.min(R.value*.3,100),t=R.value<50?1:0;return{top:"0px",transform:`translate(-50%, ${o}px)`,transition:"transform 0.3s ease, opacity 0.5s ease",opacity:t,width:"100%",padding:"1rem",backgroundImage:"url('/storage/local/images/shop/brand/background.png')",backgroundRepeat:"repeat-x",backgroundSize:S.value?"auto 100%":"auto 0%"}}),$=()=>{S.value=window.innerWidth>=768,window.addEventListener("resize",$)};function F(){p.order_list=u.value,p.discount=N.value,p.transaction=v.value-(N.value??0),p.post(route("shop.checkout"),{onError:o=>{for(let t in o)_.value.showToast("warning",o[t])}})}function Y(o){const t=document.getElementById("voucherDetailTrigger"+o);t.innerHTML=="Click to see voucher detail"?t.innerHTML="Hide voucher detail":t.innerHTML="Click to see voucher detail"}function G(o,t){P.value?P.value.showModal(o,t):console.error("modalConfirmationRef is null")}return X(()=>{var o;window.addEventListener("resize",$),window.addEventListener("scroll",V),p.voucher_id=((o=b.active_transaction)==null?void 0:o.voucher_id)??null}),Z(()=>{window.removeEventListener("resize",$),window.removeEventListener("scroll",V)}),W(()=>b.notif,o=>{const t=o;_.value.showToast(t.type,t.message)}),W(()=>v.value,o=>{const t=o,T=b.customer_voucher.find(e=>e.id==p.voucher_id);t<(T==null?void 0:T.min_transaction)&&(_.value.showToast("warning",["Subtotal is less than minimum transaction."]),setTimeout(()=>{p.voucher_id=null,_.value.showToast("warning",["Voucher removed."])},1e3))}),(o,t)=>{var T;return d(),l(w,null,[M(as,null,{default:q(()=>[M(i(ss),{title:A.value},null,8,["title"]),M(os,{ref_key:"modalConfirmationRef",ref:P},null,512),M(ns,{ref_key:"toastNotifRef",ref:_},null,512),s("div",{class:"card rounded-0 bg-warning bg-opacity-50 position-fixed start-50 translate-middle-x z-3",style:O(U.value)},[s("div",is,[s("div",ls,[s("button",{class:"btn btn-sm btn-light text-primary",onClick:t[0]||(t[0]=e=>i(ts).visit(o.route("shop")))},[...t[9]||(t[9]=[s("i",{class:"bi bi-chevron-left"},null,-1),s("span",{class:"d-none d-lg-inline ms-2"},n("Back"),-1)])]),t[11]||(t[11]=s("div",{class:"border-start border-primary border-2 mx-2 mx-lg-4"},null,-1)),s("span",ds,[t[10]||(t[10]=s("i",{class:"bi bi-shop me-0 d-inline d-lg-inline"},null,-1)),f(" "+n("Stand "+C.stand.name),1)])])])],4),s("div",rs,[s("div",cs,[s("div",ps,[s("div",us,[s("button",{class:x("btn btn-sm btn-outline-primary border-0 w-50 me-2 "+(y.value==1?"active":"")),onClick:t[1]||(t[1]=e=>y.value=0)},[...t[12]||(t[12]=[s("i",{class:"fa-solid fa-utensils me-1"},null,-1),f(" "+n("Menu"),-1)])],2),s("button",{class:x("btn btn-sm btn-outline-primary border-0 w-50 "+(y.value==2?"active":"")),onClick:t[2]||(t[2]=e=>y.value=0)},[t[13]||(t[13]=s("i",{class:"bi bi-cart4 me-1"},null,-1)),t[14]||(t[14]=s("span",{class:"position-relative"},n("Cart"),-1)),u.value.length>0&&y.value!=2?(d(),l("span",ms,n(u.value.length),1)):g("",!0)],2)])]),M(B,{name:"fade-slide-ltr",onAfterLeave:t[4]||(t[4]=e=>y.value=2)},{default:q(()=>[y.value==1||S.value?(d(),l("div",bs,[s("div",_s,[s("div",ys,[t[16]||(t[16]=s("span",{class:"text-secondary m-3"},[s("i",{class:"fa-solid fa-utensils me-2"}),f(" "+n("Menu List"))],-1)),s("span",gs,[t[15]||(t[15]=f(n("order type :")+" ",-1)),s("span",fs,n(H.value),1)])]),s("div",xs,[u.value.length==0?(d(),l("div",ws,[s("span",vs,n(i(z)?"Click on the menu to add to cart":"Please login to add menu to cart"),1)])):g("",!0),(d(!0),l(w,null,k(C.menu_group,(e,r)=>(d(),l("li",hs,[s("ul",ks,[s("span",Cs,n(r),1)]),(d(!0),l(w,null,k(e,a=>(d(),l("ul",{class:x("list-group-item list-group-item-action px-2 py-1 mb-0 "+(a.sale<a.stock?"":"bg-secondary bg-opacity-10")),onClick:()=>{i(z)?a.sale<a.stock?u.value.find(c=>c.id==a.id)?u.value.find(c=>c.id==a.id).qty++:u.value.push({id:a.id,name:a.name,price:a.price,image:a.image,qty:1}):(_.value.showToast("info","Sorry for the incovenience, "+a.name+" is Out of Stock. "),_.value.showToast("info","We appreciate you enthusiasm. We`ll add more stock next time!")):G(o.route("post.login"),"Please login to add menu to cart")}},[s("div",Ss,[s("div",{class:"rounded-3 d-inline-block float-start",style:O({width:S.value?"20%":"30%"})},[s("img",{src:a.image?"/storage/images/shop/foods/menu/"+a.image:"/storage/images/shop/foods/menu/default.png",alt:"image",class:"placeholder img-fluid rounded",onLoad:t[3]||(t[3]=(...c)=>i(D)&&i(D)(...c)),style:{"aspect-ratio":"1"}},null,40,Ts)],4),s("div",{class:"ps-2 d-inline-block",style:O({width:S.value?"80%":"70%"})},[s("div",Ms,[s("div",Ls,[s("div",Ns,[s("span",Os,n(a.name),1)])])]),s("div",null,[t[17]||(t[17]=s("span",{class:"text-secondary d-inline-block my-auto",style:{width:"60px","font-size":"0.8rem"}},n("Price"),-1)),t[18]||(t[18]=s("span",null,n(":"),-1)),s("span",Ds,n(i(m)(a.price)),1)]),s("div",Ps,[t[19]||(t[19]=s("span",{class:"text-secondary d-inline-block my-auto",style:{width:"60px","font-size":"0.8rem"}},n("Detail"),-1)),s("span",Rs,n(":")+" "+n((!(a.volume>0)&&!(a.mass>0)?"- ":"")+(a.volume>0?a.volume+a.volume_unit+" ":"")+(a.volume>0&&a.mass>0?"- ":"")+(a.mass>0?a.mass+a.mass_unit+" ":"")),1)]),s("div",$s,[t[20]||(t[20]=s("span",{class:"text-secondary d-inline-block my-auto",style:{width:"60px","font-size":"0.8rem"}},n("Taste"),-1)),t[21]||(t[21]=s("span",null,n(":"),-1)),s("div",qs,[(d(!0),l(w,null,k(a.tags,c=>(d(),l("span",Vs,n(c.name),1))),256)),a.tags.length==0?(d(),l("span",Es,n("None"))):g("",!0)])]),s("div",Is,[t[22]||(t[22]=s("span",{class:"text-secondary d-inline-block",style:{width:"60px","font-size":"0.8rem"}},n("Sold "),-1)),s("span",Ws,n(": "+a.sale),1),s("div",{class:x("card bg-opacity-10 px-2 d-inline-block float-end bg-"+(a.sale<a.stock?"warning":"secondary"))},[s("span",{class:x("text-"+(a.sale<a.stock?"secondary":"primary")),style:{"font-size":"0.8rem"}},n(a.sale<a.stock?"Ready Stock":"Out of Stock"),3)],2)])],4)])],10,zs))),256))]))),256))])])])):g("",!0)]),_:1}),M(B,{name:"fade-slide-rtl",onAfterLeave:t[7]||(t[7]=e=>y.value=1)},{default:q(()=>{var e;return[y.value==2||S.value?(d(),l("div",Bs,[s("div",js,[t[26]||(t[26]=s("div",{class:"d-flex border-bottom border-2 border-primary mb-3 pb-1"},[s("span",{class:"h6 text-primary-emphasis mx-auto"},[s("i",{class:"bi bi-cart4 me-0"}),f(" "+n("My Order"))])],-1)),u.value.length==0?(d(),l("div",As,[s("span",Hs,n(i(z)?"Click on the menu to add to cart":"Please login to add menu to cart"),1)])):g("",!0),s("div",Us,[s("li",Fs,[(d(!0),l(w,null,k(u.value,(r,a)=>(d(),l("ul",Ys,[s("div",Gs,[s("img",{src:"/storage/images/shop/foods/menu/"+((r==null?void 0:r.image)??"default.png"),alt:"image",style:{"aspect-ratio":"1",width:"100%"},class:"placeholder img-fluid rounded",onLoad:t[5]||(t[5]=(...c)=>i(D)&&i(D)(...c))},null,40,Js)]),s("div",Ks,[s("span",Qs,n(r.name),1),s("div",Xs,[t[23]||(t[23]=s("span",{class:"d-inline-block text-secondary my-auto",style:{width:"60px","font-size":"0.8rem"}},n("Price"),-1)),s("span",Zs,n(": "+i(m)(r.price)),1)]),s("div",st,[t[24]||(t[24]=s("span",{class:"d-inline-block text-secondary my-auto",style:{width:"60px","font-size":"0.8rem"}},n("Total"),-1)),s("span",tt,n(": "+i(m)(r.price*r.qty)),1)]),s("div",et,[s("button",{class:"btn btn-sm btn-outline-primary border-0 py-0 ms-auto",onClick:c=>{r.qty>1?r.qty--:u.value.splice(a,1)}},[s("i",{class:x("bi bi-"+(r.qty>1?"dash":"trash3"))},null,2)],8,nt),s("span",at,n(r.qty),1),s("button",{class:"btn btn-sm btn-outline-primary border-0 py-0",onClick:c=>r.qty++},[...t[25]||(t[25]=[s("i",{class:x("bi bi-plus")},null,-1)])],8,ot)])])]))),256))])])]),s("div",it,[s("div",lt,[s("span",dt,n("Subtotal ( "+E.value+(E.value>1?" items":" item")+" )"),1),s("span",rt,n(i(m)(v.value??0)),1)]),s("div",ct,[t[28]||(t[28]=s("span",{class:"text-secondary my-auto"},n("Voucher"),-1)),s("div",pt,[s("button",{disabled:!i(z),"data-bs-toggle":"modal","data-bs-target":"#voucherModal",type:"button",class:"btn btn-sm card-bg-hover-warning text-warning-emphasis border-0 p-1 px-2 px-1"},[s("span",mt,n(((e=C.customer_voucher.find(r=>r.id==i(p).voucher_id))==null?void 0:e.code)??"Click here"),1),t[27]||(t[27]=s("i",{class:"fa-solid fa-ticket ms-2 rounded"},null,-1))],8,ut)])]),s("div",bt,[t[29]||(t[29]=s("span",{class:"text-secondary"},n("Discount"),-1)),s("span",_t,n(i(m)(N.value??0)),1)]),s("div",yt,[s("button",{disabled:!i(z)||u.value.length==0,class:"btn btn-sm btn-warning w-50",onClick:t[6]||(t[6]=r=>i(z)&&u.value.length>0?F():null)},[...t[30]||(t[30]=[s("span",{class:"h6 mb-0"},[s("i",{class:"bi bi-cart-check me-1"}),f(" "+n("Checkout"))],-1)])],8,gt),s("span",ft,n(i(m)(v.value-(N.value??0))),1)])])])):g("",!0)]}),_:1})])])]),_:1}),s("div",xt,[s("div",wt,[s("div",vt,[t[33]||(t[33]=es('<div class="modal-header py-1 ps-3 pe-2"><span class="modal-title fs-5 text-primary-emphasis"><i class="fa-solid fa-ticket pe-2"></i> Available Voucher</span><button type="button" class="btn btn-sm ms-auto" data-bs-dismiss="modal"><i class="bi bi-x-lg"></i></button></div>',1)),s("div",ht,[s("div",kt,[s("div",Ct,[(d(!0),l(w,null,k(C.customer_voucher,e=>{var r,a;return d(),l("div",{key:e.id,class:"position-relative bg-warning bg-opacity-25 d-flex rounded-4 mb-3"},[(d(),l(w,null,k([{top:"30%",left:"0"},{top:"70%",left:"0"},{top:"30%",left:"100%"},{top:"70%",left:"100%"}],c=>s("div",{class:"position-absolute rounded-circle p-3 bg-white",style:O({top:c.top,left:c.left,transform:"translate(-50%, -50%)"})},null,4)),64)),s("div",zt,[s("img",{src:"/storage/images/shop/voucher/"+((e==null?void 0:e.image)??"default.png"),class:"rounded-3 my-auto",alt:"Ticket Image",style:{aspectRatio:"1/1",width:"100%",minWidth:"90px",backgroundSize:"cover"}},null,8,St),s("div",Tt,[s("div",Mt,[s("span",Lt,n((e==null?void 0:e.discount_type)=="price"?"DISCOUNT "+i(m)(e==null?void 0:e.discount_price)+"!":"DISCOUNT "+(e==null?void 0:e.discount_percent)+"%!"),1)]),s("div",Nt,[s("span",Ot,[t[31]||(t[31]=f(n("PROMO : ")+" ",-1)),s("span",Dt,n(((e==null?void 0:e.name)??"No Name").toUpperCase()),1)])]),s("div",Pt,[s("span",Rt,n(i(j)(e==null?void 0:e.start_date,"d MMM yyy")+" - "+i(j)(e==null?void 0:e.end_date,"d MMM yyy")),1)]),s("div",$t,[s("div",qt,[s("button",{id:"voucherDetailTrigger"+(e==null?void 0:e.id),class:"btn btn-sm text-primary card-bg-hover border-0 py-1",style:{"font-size":"0.8rem"},"data-bs-toggle":"collapse","data-bs-target":"#voucherDetail"+(e==null?void 0:e.id),onClick:c=>Y(e==null?void 0:e.id)},n("Click to see voucher detail"),8,Vt),s("div",{class:"collapse",id:"voucherDetail"+(e==null?void 0:e.id),style:{"font-size":"0.8rem"}},[s("li",It,[(d(!0),l(w,null,k({min_transaction:{text:"Minimum transaction is "+i(m)(e==null?void 0:e.min_transaction)+".",sub:"Transaksi minimum senilai "+i(m)(e==null?void 0:e.min_transaction)+"."},discount_max_price:{text:e.discount_type=="percent"?"Maximum discount price is "+i(m)(e==null?void 0:e.discount_max_price)+".":null,sub:e.discount_type=="percent"?"Potongan harga paling besar senilai "+i(m)(e==null?void 0:e.discount_max_price)+".":null}},(c,J)=>(d(),l("ul",Wt,[s("div",Bt,[s("p",jt,[f(n(c.text)+" ",1),J=="min_transaction"&&v.value<(e==null?void 0:e.min_transaction)?(d(),l("i",At)):g("",!0)]),s("p",Ht,n(c.sub),1)])]))),256))])],8,Et)])]),s("div",Ut,[s("button",{"data-bs-dismiss":"modal",class:x("btn btn-sm "+(v.value<(e==null?void 0:e.min_transaction)?"disabled ":" ")+(((r=i(p))==null?void 0:r.voucher_id)==(e==null?void 0:e.id)?"w-75 btn-success ":"w-100 btn-primary ")),onClick:()=>{i(p).voucher_id=e.id,_.value.showToast("info","Voucher applied!")}},n(i(p).voucher_id==e.id?"Applied":"Use Voucher"),11,Ft),((a=i(p))==null?void 0:a.voucher_id)==(e==null?void 0:e.id)?(d(),l("button",{key:0,onClick:t[8]||(t[8]=()=>{i(p).voucher_id=null,_.value.showToast("warning","Voucher canceled")}),class:"btn btn-sm btn-outline-secondary w-25 ms-2"},n("Cancel"))):g("",!0)])])])])}),128)),((T=C.customer_voucher)==null?void 0:T.length)>0?g("",!0):(d(),l("div",Yt,[...t[32]||(t[32]=[s("div",{class:"d-flex"},[s("span",{class:"text-secondary mx-auto"},n("No voucher available"))],-1),s("div",{class:"d-flex"},[s("span",{class:"text-secondary mx-auto fst-italic",style:{"font-size":"0.8rem"}},n("Redeem voucher using points"))],-1)])]))])])])])])])],64)}}};export{te as default};
