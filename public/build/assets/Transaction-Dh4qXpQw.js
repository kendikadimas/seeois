import{s as W,r as y,k as A,u as H,D as J,H as K,p as Q,x as X,o as c,j as N,b as h,a as t,d as n,h as Z,B as P,I as L,t as e,i as u,c as p,f as w,n as l,F as z,y as M,T as S,e as tt,g as st}from"./app-BNtVQNrL.js";import{_ as et}from"./Notif-Bg7tiFP3.js";import{G as at}from"./GuestLayout-sKdK8xas.js";import{_ as nt}from"./ModalConfirmation-Cxu8SiV9.js";import{M as ot}from"./ModalAlertNotification-BGLstggn.js";import{a as G,f as _}from"./utils-Dr-qEmMV.js";import{f as g}from"./format-DFpGNh8k.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const it={class:"card shadow-lg mx-auto px-3 py-3"},lt={class:"d-flex text-primary-emphasis"},rt={class:"d-flex"},dt={class:"h5 my-auto"},ct={class:"container",style:{"margin-top":"8rem"}},ut={class:"row g-4"},pt={class:"col-12 col-xl-7"},mt={class:"card bg-white shadow-sm"},yt={class:"d-flex px-3 py-2"},vt={class:"scroll-container-3 scroll-container-lg-2 pe-1"},bt={class:"list-group list-group-flush"},ft={class:"list-group-item list-group-item-action px-0 py-1 mb-0"},gt=["src"],xt={class:"d-block text-primary-emphasis"},ht={class:"d-flex"},wt={class:""},_t={class:""},kt={class:"ms-auto"},Dt={class:"h6 d-inline-block",style:{width:"6rem"}},Ct={class:"d-flex mt-2 px-3"},Tt={class:"ms-auto"},At={class:"d-flex mt-2 px-3"},Nt={class:"bg-warning bg-opacity-10 ms-auto rounded px-2"},Pt={class:"d-flex mt-2 px-3"},zt={class:"ms-auto"},Mt={class:"d-flex mt-2 rounded bg-warning bg-opacity-25 p-2 mx-3 mb-3"},Rt={class:"h6 my-auto ms-auto text-warning-emphasis"},$t={class:"col-12 col-xl-5"},Et={class:"card p-3 shadow-sm"},Lt={class:"d-flex"},St={key:0,class:"w-50 rounded card-bg-hover-warning"},Gt={key:1,class:"w-50 rounded card-bg-hover-warning"},Ot={class:"d-flex"},Bt={class:"d-flex mt-2"},jt={class:"text-secondary",style:{"font-size":"0.8rem"}},qt={class:"d-flex my-1"},Ft={class:"text-warning-emphasis h6 mb-0"},Ut={class:"d-flex"},Vt={class:"icon icon-dana d-inline rounded-circle border-primary border",style:{width:"1rem",height:"1rem",padding:"0.1rem"}},It={key:0},Yt={class:"collapse multi-collapse",id:"paymentGuideCollapseCash"},Wt={class:"list-group list-group-flush"},Ht={style:{"font-size":"0.8rem"},class:"list-group-item list-group-item-light mb-0"},Jt={class:"mb-0"},Kt={class:"mb-0 text-secondary fst-italic"},Qt={class:"input-group input-group-sm"},Xt=["placeholder","required"],Zt={key:0},ts={class:"collapse multi-collapse",id:"paymentGuideCollapseDana"},ss={class:"list-group list-group-flush"},es={style:{"font-size":"0.8rem"},class:"list-group-item list-group-item-light mb-0"},as={class:"mb-0"},ns={class:"mb-0 text-secondary fst-italic"},os={class:"d-flex"},is={class:"text-secondary",style:{}},ls={class:"text-dark"},rs={class:"d-flex"},ds={class:"h6",style:{}},cs={class:"input-group input-group-sm border rounded"},us=["placeholder"],ps={class:"d-flex mt-3"},ms={class:"h6 mb-0"},_s={__name:"Transaction",props:{notif:Object,transaction:Object,stand:Object,dana_contact:Object},setup(o){const d=o;W().props.auth.user;const O=y("Payment Transaction"),f=y(null),B=y(null),j=y(null),R=y(null),v=y(window.innerWidth>=1200),k=y("show"),r=y("cash"),b=y(d.stand.type>0?"delivery":"pick_up"),D=y(0),$=()=>{D.value=window.scrollY},q=A(()=>{const i=Math.min(D.value*.3,100),s=D.value<50?1:0;return{top:"0px",transform:`translate(-50%, ${i}px)`,transition:"transform 0.3s ease, opacity 0.5s ease",opacity:s,width:"100%",padding:"1rem",backgroundImage:"url('/storage/local/images/shop/brand/background.png')",backgroundRepeat:"repeat-x",backgroundSize:v.value?"auto 100%":"auto 0%"}}),C=()=>{v.value=window.innerWidth>=768,window.addEventListener("resize",C)},E=A(()=>d.transaction.order_list.reduce((i,s)=>i+Number(s.qty),0)),F=A(()=>d.transaction.order_list.reduce((i,s)=>i+Number(s.qty)*s.price,0)),m=H({order_type:null,send_option:null,payment_method:null,payment_price:null,dana_receipt:null});function U(){if(m.payment_method=r.value,m.order_type=g(new Date,"yyyy-MM-dd")==g(new Date(d.stand.date),"yyyy-MM-dd")?"now":"pre_order",m.send_option=b.value,m.payment_price<d.transaction.transaction&&m.payment_method=="cash")return f.value.showToast("danger","Payment Price can is less than Total Transaction!");m.post(route("customer.order.add"),{onSuccess:()=>{setTimeout(()=>{L.visit(route("shop.stand",[d.transaction.stand_id,"new"]))},200)},onError:i=>{for(let s in i)f.value.showToast("warning",i[s])}})}const V=i=>{m.dana_receipt=i.target.files[0]};function I(){R.value.click()}function Y(){navigator.clipboard?navigator.clipboard.writeText(d.dana_contact.phone).then(()=>{f.value.showToast("info","Copied "+d.dana_contact.name+" DANA Number to clipboard.")}).catch(()=>{f.value.showToast("warning",["Can not copy "+d.dana_contact.name+" DANA Number.","Browser is not supported. Please copy manually."])}):f.value.showToast("warning",["Can not copy "+d.dana_contact.name+" DANA Number.","Browser is not supported. Please copy manually."])}return J(()=>{window.addEventListener("resize",C),window.addEventListener("scroll",$),console.log(new Date==new Date(d.stand.date))}),K(()=>{window.removeEventListener("resize",C),window.removeEventListener("scroll",$)}),Q(()=>d.notif,i=>{const s=i;f.value.showToast(s.type,s.message)}),(i,s)=>(c(),X(at,null,{default:N(()=>[h(n(Z),{title:O.value},null,8,["title"]),h(nt,{ref_key:"modalConfirmationRef",ref:B},null,512),h(ot,{ref_key:"modalAlertNotificationRef",ref:j},null,512),h(et,{ref_key:"toastNotifRef",ref:f},null,512),t("div",{class:"card rounded-0 bg-warning bg-opacity-50 position-fixed start-50 translate-middle-x z-3",style:P(q.value)},[t("div",it,[t("div",lt,[t("button",{class:"btn btn-sm btn-light text-primary",onClick:s[0]||(s[0]=a=>n(L).visit(i.route("shop.stand",o.transaction.stand_id)))},[...s[13]||(s[13]=[t("i",{class:"bi bi-chevron-left"},null,-1),t("span",{class:"d-none d-lg-inline ms-2"},e("Back"),-1)])]),s[14]||(s[14]=t("div",{class:"border-start border-primary border-2 mx-2 mx-lg-4"},null,-1)),t("div",rt,[t("span",dt,e(v.value?"Payment Transaction":"Payment"),1)])])])],4),t("div",ct,[t("div",ut,[t("div",pt,[t("div",mt,[s[22]||(s[22]=t("div",{class:"d-flex shadow-sm p-3 bg-white rounded-top"},[t("span",{class:"h6 text-primary-emphasis mb-0"},[t("i",{class:"bi bi-cart4 me-2"}),u(" "+e("Order Detail"))])],-1)),t("div",yt,[s[15]||(s[15]=t("span",{class:"text-secondary h6 mb-0"},e("Menu"),-1)),t("span",{class:l("ms-auto text-secondary mt-auto "+(v.value?"":"border-end border-primary border-2 pe-2")),style:{"font-size":"0.8rem"}},e(E.value+(E.value>1?" items":" item")),3),v.value?w("",!0):(c(),p("button",{key:0,"data-bs-toggle":"collapse","data-bs-target":"#menu_collapse",class:"btn btn-sm btn-outline-primary border-0 py-0",style:{"font-size":"0.8rem"},id:"menu_collapse_trigger",onClick:s[1]||(s[1]=()=>{k.value=k.value=="show"?"hide":"show"})},e(k.value),1))]),t("div",{class:l("collapse "+(v.value?"show":"")),id:"menu_collapse"},[t("div",vt,[t("li",bt,[(c(!0),p(z,null,M(o.transaction.order_list,(a,T)=>(c(),p("ul",ft,[t("div",{class:"float-start p-2",style:P({width:v.value?"15%":"20%"})},[t("img",{src:"/storage/images/shop/foods/menu/"+((a==null?void 0:a.image)??"default.png"),alt:"image",style:{"aspect-ratio":"1",width:"100%"},class:"placeholder img-fluid rounded",onLoad:s[2]||(s[2]=(...x)=>n(G)&&n(G)(...x))},null,40,gt)],4),t("div",{class:"float-end py-2 my-auto",style:P({width:v.value?"85%":"80%"})},[t("span",xt,e("( "+a.qty+" ) "+a.name),1),t("div",ht,[t("div",wt,[s[16]||(s[16]=t("span",{class:"d-inline-block text-secondary my-auto",style:{width:"2.5rem","font-size":"0.8rem"}},e("Price"),-1)),t("span",_t,e(": "+n(_)(a.price)),1)]),t("div",kt,[s[17]||(s[17]=t("span",{class:"d-inline-block text-secondary my-auto",style:{width:"2.5rem","font-size":"0.8rem"}},e("Total"),-1)),t("span",Dt,e(": "+n(_)(a.price*a.qty)),1)])])],4)]))),256))])])],2),s[23]||(s[23]=t("div",{class:"d-flex px-3 py-2"},[t("span",{class:"text-secondary h6 mb-0"},e("Transaction"))],-1)),t("div",Ct,[s[18]||(s[18]=t("span",{class:"text-secondary"},e("Subtotal"),-1)),t("span",Tt,e(n(_)(F.value??0)),1)]),t("div",At,[s[19]||(s[19]=t("span",{class:"text-secondary my-auto"},e("Voucher"),-1)),t("div",Nt,e(o.transaction.voucher_id>0?"Applied":"Not Used"),1)]),t("div",Pt,[s[20]||(s[20]=t("span",{class:"text-secondary"},e("Discount"),-1)),t("span",zt,e(n(_)(o.transaction.discount??0)),1)]),t("div",Mt,[s[21]||(s[21]=t("span",null,e("Total"),-1)),t("span",Rt,e(n(_)(o.transaction.transaction)),1)])])]),t("div",$t,[t("div",Et,[s[36]||(s[36]=t("div",{class:"d-flex border-bottom border-primary border-2 pb-2"},[t("span",{class:"mb-0 h6 text-primary-emphasis"},[t("i",{class:"fa-solid fa-cash-register me-2"}),u(e("PAYMENT"))])],-1)),s[37]||(s[37]=t("div",{class:"d-flex mt-2"},[t("span",{class:"text-secondary",style:{"font-size":"0.8rem"}},e("Order Type"))],-1)),t("div",Lt,[n(g)(new Date,"yyyy-MM-dd")==n(g)(new Date(o.stand.date),"yyyy-MM-dd")?(c(),p("div",St,[...s[24]||(s[24]=[t("div",{class:l("card bg-warning bg-opacity-10")},[t("span",{class:l("mx-auto text-dark")},[t("i",{class:"bi bi-calendar-check me-1"}),u(" "+e("Now"))])],-1)])])):w("",!0),n(g)(new Date,"yyyy-MM-dd")<n(g)(new Date(o.stand.date),"yyyy-MM-dd")?(c(),p("div",Gt,[...s[25]||(s[25]=[t("div",{class:l("card bg-warning bg-opacity-10")},[t("span",{class:l("mx-auto text-dark")},[t("i",{class:"bi bi-calendar-week me-1"}),u(" "+e("Pre-Order"))])],-1)])])):w("",!0)]),s[38]||(s[38]=t("div",{class:"d-flex mt-2"},[t("span",{class:"text-secondary",style:{"font-size":"0.8rem"}},e("Send Option"))],-1)),t("div",Ot,[o.stand.type!=1?(c(),p("div",{key:0,class:"w-50 rounded card-bg-hover-warning",onClick:s[3]||(s[3]=a=>b.value="pick_up")},[t("div",{class:l("card "+(b.value=="pick_up"?"bg-warning bg-opacity-10":""))},[t("span",{class:l("mx-auto "+(b.value=="pick_up"?"text-dark":"text-secondary"))},[...s[26]||(s[26]=[t("i",{class:"bi bi-person-arms-up me-1"},null,-1),u(" "+e("Pick Up"),-1)])],2)],2)])):w("",!0),t("div",{class:"w-50 rounded card-bg-hover-warning",onClick:s[4]||(s[4]=a=>b.value="delivery")},[t("div",{class:l("card "+(b.value=="delivery"?"bg-warning bg-opacity-10":""))},[t("span",{class:l("mx-auto "+(b.value=="delivery"?"text-dark":"text-secondary"))},[...s[27]||(s[27]=[t("i",{class:"fa-solid fa-truck-fast me-1"},null,-1),u(" "+e("Delivery"),-1)])],2)],2)])]),t("div",Bt,[t("span",jt,e((b.value=="pick_up"?"Pick up ":"Delivery ")+" Date"),1)]),t("div",qt,[t("span",Ft,e(n(g)(o.stand.date,"EEEE, dd MMM yyy")),1)]),s[39]||(s[39]=t("div",{class:"d-flex mt-2"},[t("span",{class:"text-secondary",style:{"font-size":"0.8rem"}},e("Payment Method"))],-1)),t("div",Ut,[t("div",{class:"w-50 rounded card-bg-hover-warning",onClick:s[5]||(s[5]=a=>r.value="")},[t("div",{class:l("card "+(r.value=="cash"?"bg-warning bg-opacity-10":""))},[t("span",{class:l("mx-auto "+(r.value=="cash"?"text-dark":"text-secondary"))},[...s[28]||(s[28]=[t("i",{class:"fa-solid fa-money-bill-wave me-2 text-primary"},null,-1),u(" "+e("Cash"),-1)])],2)],2)]),t("div",{class:"w-50 rounded card-bg-hover-warning",onClick:s[6]||(s[6]=a=>r.value="")},[t("div",{class:l("card "+(r.value=="dana"?"bg-warning bg-opacity-10":""))},[t("span",{class:l("mx-auto "+(r.value=="dana"?"text-dark":"text-secondary"))},[(c(),p("svg",Vt,[...s[29]||(s[29]=[t("use",{href:"/icons.svg#dana"},null,-1)])])),s[30]||(s[30]=u(" "+e("Dana"),-1))],2)],2)])]),s[40]||(s[40]=t("div",{class:"d-flex mt-3"},[t("button",{type:"button","data-bs-toggle":"collapse","data-bs-target":".multi-collapse","aria-controls":"paymentGuideCollapseCash paymentGuideCollapseDana",class:"btn btn-outline-secondary btn-sm py-0 w-100 border"},[t("span",{style:{"font-size":"0.8rem"}},e("Payment Guide"))])],-1)),h(S,{name:"fade-slide-ltr",onAfterLeave:s[8]||(s[8]=a=>r.value="dana")},{default:N(()=>[r.value=="cash"?(c(),p("div",It,[t("div",Yt,[t("li",Wt,[(c(),p(z,null,M([{text:"Please give the cash to the courier when you receive the order.",sub:"Anda dapat memberikan uangnya kepada kurir ketika menerima pesanan."},{text:"Please fill the 'Payment Price'. For the courier will bring the payment change.",sub:"Silakan mengisi 'Payment Price' sesuai nominal uang yang akan diberikan. Agar kurir dapat memberikan kembalian."}],a=>t("ul",Ht,[t("p",Jt,e(a.text),1),t("p",Kt,e(a.sub),1)])),64))])]),s[32]||(s[32]=t("div",{class:"d-flex mt-2"},[t("span",{class:"text-secondary",style:{"font-size":"0.8rem"}},[u(e("Payment Price")+" "),t("i",{"data-bs-target":"#paymentGuideCollapseCash","data-bs-toggle":"collapse",class:"bi bi-info-circle ms-1 my-auto",style:{"font-size":"0.6rem"}})])],-1)),t("div",Qt,[s[31]||(s[31]=t("label",{for:"payment_price",class:"input-group-text"},e("Rp"),-1)),tt(t("input",{type:"number",id:"payment_price",class:"form-control",placeholder:"e.g "+o.transaction.transaction,required:r.value=="cash","onUpdate:modelValue":s[7]||(s[7]=a=>n(m).payment_price=a)},null,8,Xt),[[st,n(m).payment_price]])])])):w("",!0)]),_:1}),h(S,{name:"fade-slide-rtl",onAfterLeave:s[11]||(s[11]=a=>r.value="cash")},{default:N(()=>{var a,T;return[r.value=="dana"?(c(),p("div",Zt,[t("div",ts,[t("li",ss,[(c(),p(z,null,M([{text:"Please upload the transfer receipt of DANA to the 'DANA Receipt'.",sub:"Silakan mengunggah bukti transfer DANA ke bagian 'DANA Receipt'."},{text:"Please transfer exact amount of 'Total Transaction'.",sub:"Mohon untuk mentransfer jumlah yang sesuai dengan 'Total Transaction'."}],x=>t("ul",es,[t("p",as,e(x.text),1),t("p",ns,e(x.sub),1)])),64))])]),s[33]||(s[33]=t("div",{class:"d-flex mt-2"},[t("span",{class:"text-secondary",style:{"font-size":"0.8rem"}},e("DANA Contact"))],-1)),t("div",os,[t("span",is,[u(e(o.dana_contact.name+" - ")+" ",1),t("span",ls,e(o.dana_contact.phone),1)]),t("i",{class:"bi bi-copy text-secondary card-bg-hover px-2 rounded",onClick:s[9]||(s[9]=x=>Y())})]),s[34]||(s[34]=t("div",{class:"d-flex mt-2"},[t("span",{class:"text-secondary",style:{"font-size":"0.8rem"}},e("Total Transaction"))],-1)),t("div",rs,[t("span",ds,e(n(_)(o.transaction.transaction)),1)]),s[35]||(s[35]=t("div",{class:"d-flex mt-2"},[t("span",{class:"text-secondary",style:{"font-size":"0.8rem"}},[u(e("DANA Receipt")+" "),t("i",{"data-bs-target":"#paymentGuideCollapseDana","data-bs-toggle":"collapse",class:"bi bi-info-circle ms-1 my-auto",style:{"font-size":"0.6rem"}})])],-1)),t("div",cs,[t("button",{class:"btn btn-outline-secondary border-0",type:"button",onClick:s[10]||(s[10]=x=>I())},e("Upload Receipt")),t("input",{ref_key:"inputDanaReceiptRef",ref:R,type:"file",class:"d-none",onChange:V},null,544),t("input",{type:"text",class:"form-control",disabled:"",placeholder:((T=(a=n(m))==null?void 0:a.dana_receipt)==null?void 0:T.name)??"filename.format"},null,8,us)])])):w("",!0)]}),_:1}),t("div",ps,[t("button",{type:"button",class:"btn btn-sm btn-warning w-100",onClick:s[12]||(s[12]=a=>U())},[t("span",ms,e("Pay with "+(r.value=="cash"?"Cash On Delivery":"Dana")),1)])])])])])])]),_:1}))}};export{_s as default};
