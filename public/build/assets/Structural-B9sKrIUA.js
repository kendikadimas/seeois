import{i as J,o as i,a3 as K,e as q,l as L,a as Q,n as P,g as A,D as o,N as X,A as u,B as $,V as Z,Y as ee,L as te,c as m,d,f as y,b as t,E as se,t as a,h as w,q as oe,w as N,H as V,F,p as x}from"./vendor-DX-UyPxd.js";import{S as le}from"./StaffLayout-tuRC_TMq.js";import{_ as k}from"./InputError-2po89HeZ.js";import{_ as ae}from"./Notif-CUZ2cLZ_.js";import{_ as ne}from"./ModalConfirmation-CA9Q23sM.js";import{C as re}from"./vue-select-BP4_gdbX.js";import{s as de}from"./utils-C_0HOUGI.js";import"./bootstrap-O9kK6gmf.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const T=Object.assign({inheritAttrs:!0},{__name:"VueSelect",setup(f){return(n,p)=>(i(),J(o(re),P(A(n.$attrs)),K({_:2},[q(n.$slots,(j,h)=>({name:h,fn:L(g=>[Q(n.$slots,h,P(A(g||{})))])}))]),1040))}}),ie={class:"container me-lg-0 mx-auto mb-5"},me={class:"row mt-4"},ue={class:"col-12"},pe={class:"card shadow-sm p-lg-3 p-2"},ce={class:"d-flex"},be={class:"input-group ms-2"},fe={class:"row gx-4 mt-4 mt-lg-5"},ge=["onClick"],ve={class:"d-flex"},ye={class:"",style:{"font-size":"0.8rem"}},we={class:"text-secondary d-block mb-1"},_e={class:"h5 text-primary-emphasis d-block card-title"},xe={class:"ms-auto mb-auto d-flex",style:{"z-index":"10",position:"relative"}},ke=["onClick"],he={key:1,class:"border-start border-secondary border-2 mx-1 my-1"},De=["onClick"],Ce={key:0,class:"modal fade",id:"newDepartmentModal",tabindex:"-1","aria-labelledby":"newDepartmentModal"},Me={class:"modal-dialog modal-dialog-centered"},Se={class:"modal-content shadow mx-3"},$e={class:"modal-header py-1 ps-3 pe-2"},Ne={class:"modal-body bg-light"},Ve={class:"row justify-content-center"},je={class:"col-8 col-lg-7"},Ue={class:"input-group input-group-sm bg-secondary bg-opacity-10 border-dark"},Ee={class:"row justify-content-center mt-2"},Le={class:"col-8 col-lg-7"},ze={key:1,class:"modal fade",id:"updateDepartmentModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Be={class:"modal-dialog modal-dialog-centered"},Re={class:"modal-content shadow mx-3"},Ie={class:"modal-header py-1 ps-3 pe-2"},Oe={class:"modal-title fs-5 text-primary-emphasis",id:"exampleModalLabel"},Pe={class:"modal-body bg-light"},Ae={class:"row justify-content-center mt-0"},Fe={class:"col-8 col-lg-7"},Te={class:"row justify-content-center mt-2"},qe={class:"col-8 col-lg-7"},We={key:2,class:"modal fade",id:"deleteDepartmentModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},He={class:"modal-dialog modal-dialog-centered"},Ye={class:"modal-content shadow mx-3"},Ge={class:"modal-header py-1 ps-3 pe-2"},Je={class:"modal-title text-primary-emphasis fs-5",id:"exampleModalLabel"},Ke={class:"modal-body bg-light"},Qe={class:"row justify-content-center"},Xe={class:"col-12 col-lg-10"},Ze={class:"m-0",style:{"text-align":"justify"}},et={class:"row justify-content-center mt-2"},tt={class:"col-9 col-lg-7"},st={class:"input-group"},ct={__name:"Structural",props:{staff_list:Array,department_list:Array,filter:Object,notif:Object,errors:Object},setup(f){const n=f,p=X().props.auth.user,j=u("Structural"),h=u(null),g=u(null);u("placeholder");const D=u(null),C=u(null),M=u(null),v=u(null),c=$({category:n.filter.category,order:n.filter.order,keyword:n.filter.keyword}),b=$({name:null,manager_id:null}),r=$({name:null,manager_id:null}),_=$({password:null});function z(l){l&&(c.order=c.category==l?c.order=="asc"?"desc":"asc":"desc",c.category=l,c.keyword=null),c.post(route("structural.filter"))}function W(){b.post(route("department.add"),{onSuccess:()=>{U(!1),b.reset()}})}function H(){console.log(r),r.post(route("department.update",v.value.id),{onSuccess:()=>{B(!1),r.reset()},onError:l=>{for(let e in l)g.value.showToast("warning",l[e])}})}function Y(){var l;_.post(route("department.delete",(l=v.value)==null?void 0:l.id),{onSuccess:()=>{R(!1),_.reset()},onError:e=>{for(let S in e)g.value.showToast("warning",e[S])}})}function U(l){if(D.value==null){const e=document.getElementById("newDepartmentModal");D.value=bootstrap.Modal.getOrCreateInstance(e)}l?D.value.show():D.value.hide()}function B(l){if(C.value==null){const e=document.getElementById("updateDepartmentModal");C.value=bootstrap.Modal.getOrCreateInstance(e)}l?C.value.show():C.value.hide()}function R(l){if(M.value==null){const e=document.getElementById("deleteDepartmentModal");M.value=bootstrap.Modal.getOrCreateInstance(e)}l?M.value.show():M.value.hide()}const G=u(window.innerWidth>=768),E=()=>{G.value=window.innerWidth>=768,window.addEventListener("resize",E)};return Z(()=>{window.addEventListener("resize",E),n.notif&&g.value.showToast(n.notif.type,n.notif.message)}),ee(()=>{window.removeEventListener("resize",E)}),te(()=>n.notif,l=>{const e=l;g.value.showToast(e.type,e.message)}),(l,e)=>{var S,I,O;return i(),m(F,null,[d(le,null,{header:L(()=>[w(a(j.value),1)]),default:L(()=>[d(o(se),{title:j.value,icon:"/storage/local/images/apps/logo.png"},null,8,["title"]),d(ne,{ref_key:"modalConfirmationRef",ref:h},null,512),t("div",ie,[t("div",me,[t("div",ue,[t("div",pe,[t("div",ce,[e[17]||(e[17]=t("span",{class:"text-primary border-end border-secondary-subtle border-3 pe-3 me-3 my-auto"},a("Filter"),-1)),t("button",{onClick:e[0]||(e[0]=s=>z("name")),class:"btn text-nowrap btn-sm btn-outline-secondary border-1 rounded-2 border-secondary-subtle py-0"},[e[14]||(e[14]=w(a("Name")+" ",-1)),t("i",{class:oe("bi bi-arrow-"+(f.filter.category=="name"?f.filter.order=="asc"?"up":"down":"up"))},null,2)]),t("div",be,[N(t("input",{type:"text",class:"form-control form-control-sm py-0",placeholder:"Search","aria-label":"Search","aria-describedby":"basic-addon1","onUpdate:modelValue":e[1]||(e[1]=s=>o(c).keyword=s),onInput:e[2]||(e[2]=s=>z())},null,544),[[V,o(c).keyword]]),e[15]||(e[15]=t("span",{class:"input-group-text py-0",id:"basic-addon1"},[t("i",{class:"bi bi-search",style:"font-size: 0.9rem"})],-1))]),o(p).roles_id==1?(i(),m("button",{key:0,class:"ms-2 btn btn-sm btn-outline-primary border-0 py-0 text-nowrap",onClick:e[3]||(e[3]=s=>U(!0))},[...e[16]||(e[16]=[t("i",{class:"bi bi-plus-lg d-lg-none"},null,-1),t("span",{class:"d-none d-lg-block"},a("New Department"),-1)])])):y("",!0)])])])]),t("div",fe,[(i(!0),m(F,null,q(f.department_list,s=>(i(),m("div",{key:s.id,class:"col-lg-4 col-12"},[t("div",{class:"card department-card p-3 mb-3 mb-lg-4",style:{cursor:"pointer"},onClick:ot=>l.$inertia.visit(`/seeo/department/${s.id}`)},[t("div",ve,[t("div",ye,[t("span",we,[e[18]||(e[18]=t("i",{class:"bi bi-person-badge me-1"},null,-1)),w(" "+a(s.manager.name),1)]),t("span",_e,[e[19]||(e[19]=t("i",{class:"bi bi-building me-2"},null,-1)),w(" "+a("Department "+s.name),1)])]),t("div",xe,[o(p).roles_id==1?(i(),m("button",{key:0,class:"border-0 btn btn-sm btn-outline-secondary",onClick:x(()=>{v.value=s,o(r).name=s.name,o(r).manager_id=s.manager_id,B(!0)},["stop"]),title:"Edit Department"},[...e[20]||(e[20]=[t("i",{class:"bi bi-pencil"},null,-1)])],8,ke)):y("",!0),o(p).roles_id==1?(i(),m("div",he)):y("",!0),o(p).roles_id==1?(i(),m("button",{key:2,class:"border-0 btn btn-sm btn-outline-secondary",onClick:x(()=>{v.value=s,R(!0)},["stop"]),title:"Delete Department"},[...e[21]||(e[21]=[t("i",{class:"bi bi-trash3"},null,-1)])],8,De)):y("",!0)])])],8,ge)]))),128))])])]),_:1}),o(p).roles_id==1?(i(),m("div",Ce,[t("div",Me,[t("div",Se,[t("div",$e,[e[23]||(e[23]=t("span",{class:"modal-title fs-5 text-primary-emphasis"},[t("i",{class:"bi bi-building-add pe-2"}),w(" "+a("New Department"))],-1)),t("button",{type:"button",class:"btn btn-sm ms-auto",onClick:e[4]||(e[4]=s=>U(!1))},[...e[22]||(e[22]=[t("i",{class:"bi bi-x-lg"},null,-1)])])]),t("form",{onSubmit:e[7]||(e[7]=x(s=>W(),["prevent"]))},[t("div",Ne,[t("div",Ve,[e[25]||(e[25]=t("div",{class:"col-4 col-lg-3"},[t("label",{for:"department_name",class:"form-label d-inline-block"},a("Name"))],-1)),t("div",je,[t("div",Ue,[e[24]||(e[24]=t("label",{class:"form-label text-secondary my-auto px-2",for:"department_name"},a("Department"),-1)),N(t("input",{type:"text",class:"form-control form-control-sm",id:"department_name","onUpdate:modelValue":e[5]||(e[5]=s=>o(b).name=s),placeholder:"Finance"},null,512),[[V,o(b).name]])]),d(k,{message:o(b).errors.name,class:"mt-2"},null,8,["message"])])]),t("div",Ee,[e[26]||(e[26]=t("div",{class:"col-4 col-lg-3"},[t("label",{for:"stand_pic",class:"form-label d-inline-block"},a("Manager"))],-1)),t("div",Le,[d(T,{class:"bg-white text-nowrap",options:f.staff_list,label:"name",reduce:s=>s.id,modelValue:o(b).manager_id,"onUpdate:modelValue":e[6]||(e[6]=s=>o(b).manager_id=s),placeholder:"Select staff"},null,8,["options","reduce","modelValue"]),d(k,{message:o(b).errors.manager_id,class:"mt-2"},null,8,["message"])])])]),e[27]||(e[27]=t("div",{class:"modal-footer p-1"},[t("button",{type:"submit",class:"btn btn-sm btn-primary"},a("Create"))],-1))],32)])])])):y("",!0),o(p).roles_id==1?(i(),m("div",ze,[t("div",Be,[t("div",Re,[t("div",Ie,[t("span",Oe,[e[28]||(e[28]=t("i",{class:"bi bi-building-gear me-2"},null,-1)),w(" "+a("Update "+((S=v.value)==null?void 0:S.name))+" ",1),e[29]||(e[29]=t("span",{class:"d-none d-lg-inline"},a("Department"),-1))]),e[30]||(e[30]=t("button",{type:"button",class:"btn btn-sm ms-auto","data-bs-dismiss":"modal","aria-label":"Close"},[t("i",{class:"bi bi-x-lg"})],-1))]),t("form",{onSubmit:e[10]||(e[10]=x(s=>H(),["prevent"]))},[t("div",Pe,[t("div",Ae,[e[31]||(e[31]=t("div",{class:"col-4 col-lg-3"},[t("label",{for:"edit_department_name",class:"form-label text-sm"},"Name")],-1)),t("div",Fe,[N(t("input",{id:"edit_department_name",class:"form-control form-control-sm",type:"text",required:"","onUpdate:modelValue":e[8]||(e[8]=s=>o(r).name=s)},null,512),[[V,o(r).name]]),d(k,{messages:o(r).errors.name,class:"mt-2"},null,8,["messages"])])]),t("div",Te,[e[32]||(e[32]=t("div",{class:"col-4 col-lg-3"},[t("label",{for:"edit_department_manager",class:"form-label d-inline-block"},"Manager")],-1)),t("div",qe,[d(T,{class:"bg-white text-nowrap",options:f.staff_list,label:"name",reduce:s=>s.id,modelValue:o(r).manager_id,"onUpdate:modelValue":e[9]||(e[9]=s=>o(r).manager_id=s),placeholder:"Select staff"},null,8,["options","reduce","modelValue"]),d(k,{messages:o(r).errors.manager_id,class:"mt-2"},null,8,["messages"])])])]),e[33]||(e[33]=t("div",{class:"modal-footer p-1"},[t("button",{type:"submit",class:"btn btn-sm btn-primary shadow"}," Update ")],-1))],32)])])])):y("",!0),o(p).roles_id==1?(i(),m("div",We,[t("div",He,[t("div",Ye,[t("div",Ge,[t("span",Je,[e[34]||(e[34]=t("i",{class:"bi bi-building-exclamation me-2"},null,-1)),w(" "+a("Delete "+((I=v.value)==null?void 0:I.name))+" ",1),e[35]||(e[35]=t("span",{class:"d-none d-lg-inline"},"Department",-1))]),e[36]||(e[36]=t("button",{type:"button",class:"btn btn-sm ms-auto","data-bs-dismiss":"modal","aria-label":"Close"},[t("i",{class:"bi bi-x-lg"})],-1))]),t("form",{onSubmit:e[13]||(e[13]=x(s=>Y(),["prevent"]))},[t("div",Ke,[t("div",Qe,[t("div",Xe,[t("p",Ze,a("All program and progress in "+((O=v.value)==null?void 0:O.name)+" Department will be lost. Please make sure you have back up all the data needed."),1)])]),e[39]||(e[39]=t("div",{class:"row justify-content-center mt-2"},[t("div",{class:"col-lg-10 col-11 border-bottom"},[t("span",{class:"d-block text-center"},[t("label",{for:"password"},"Password Needed to Authorize")])])],-1)),t("div",et,[e[38]||(e[38]=t("div",{class:"col-3 col-lg-3"},[t("label",{for:"pic",class:"form-label d-inline-block"},"Password")],-1)),t("div",tt,[t("div",st,[N(t("input",{id:"password",class:"form-control",type:"password","onUpdate:modelValue":e[11]||(e[11]=s=>o(_).password=s),required:"",autocomplete:"current-password"},null,512),[[V,o(_).password]]),t("button",{type:"button",class:"btn bg-light",onClick:e[12]||(e[12]=s=>o(de)("password","password_icon_del"))},[...e[37]||(e[37]=[t("i",{class:"bi bi-eye-slash-fill",id:"password_icon_del"},null,-1)])])]),d(k,{messages:o(_).errors.password,class:"mt-2"},null,8,["messages"])])])]),e[40]||(e[40]=t("div",{class:"modal-footer p-1"},[t("button",{type:"submit",class:"btn btn-sm btn-danger shadow"}," Delete ")],-1))],32)])])])):y("",!0),d(ae,{ref_key:"toastNotifRef",ref:g},null,512)],64)}}};export{ct as default};
